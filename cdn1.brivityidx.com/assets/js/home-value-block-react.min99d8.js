var apikey="7950-1108-91D1-5743",apiUrl="https://slipstream.homejunction.com",propertyTypesUrl="/pages/search.php/metadata/values?mls_ids=<MLS_IDS>&fieldNames=propertyType",propertyType=null,dataAuth="",d=new Date,year=d.getFullYear(),time_to_sold=null,street_parsed=null,lead_response_data=null,agent_data=null,globalConfig=null,priceList=[];const settings=JSON.parse($(".home-value-react-block").attr("data-settings"));var getUrlParameter=function(e){var a,t,o=window.location.search.substring(1).split("&");for(t=0;t<o.length;t++)if((a=o[t].split("="))[0]===e)return void 0===a[1]||decodeURIComponent(a[1])};function handleFindOutClickEvent(){$(".home-value-submit").on("click",(function(){var e=1,a=setInterval((function(){$(".loading-movement .item:nth-child("+e+")").addClass("green"),++e>=6&&clearInterval(a)}),1800);initAutocomplete("#home_value_1_search_address",!0),initAutocomplete("#home_value_2_search_address",!0),initAutocomplete("#hero_2_search_address",!0),initAutocomplete("#hero_3_search_address",!0);var t=$("#home_value_1_search_address"),o=$("#home_value_2_search_address"),r=$("#hero_2_search_address"),i=$("#hero_3_search_address"),l=$("#search_address"),n=$("#street"),s=$("#zipcode");(t&&t.val()||o&&o.val()||r&&r.val()||i&&i.val()||l&&l.val())&&n&&n.val()&&s&&s.val()?(t&&t.val()&&t.val().trim(),o&&o.val()&&o.val().trim(),r&&r.val()&&r.val().trim(),i&&i.val()&&i.val().trim(),n.val().trim(),s.val().trim(),$("#hv-loading").modal("show"),"undefined"!=typeof grecaptcha&&grecaptcha.ready((function(){grecaptcha.execute("6LfNOsoUAAAAAKTst6hjCdK0tmeiA4GVzqBjwScC",{action:"share_home_with_agent"}).then((function(e){setPartialLead(e)}))})),formatPropertyTypeUrl(),get_property_data()):alert("Please enter a valid home address")}))}function formatPropertyTypeUrl(){var e=window.globalSiteVariables.siteMlses.map((e=>e.mls_id)).join(",");propertyTypesUrl=propertyTypesUrl.replace("<MLS_IDS>",e)}function setPartialLead(e){var a=$("#address_auto").val(),t=$("#city").val(),o=$("#zipcode").val(),r=$("#state").val(),i=$("#county").val();street_parsed=a.split(",");let l="brivity_idx";const n=window.location.search;new URLSearchParams(n).has("utm_source")&&(l="brivity_connect"),a&&t&&o&&$("#huser_id").val()?null!=lead_response_data&&$.ajax({url:"/pages/home_value_partial_lead.php",method:"POST",dataType:"json",data:{user_email:lead_response_data.email||"",user_f_name:lead_response_data.first_name||"",user_l_name:lead_response_data.last_name||"",user_phone:lead_response_data.phone||"",street_address:street_parsed[0],city:t,zipcode:o,state:r,county:i,form_source_url:window.location.href,source:l,tags:settings.tagsData.join(","),recaptchaToken:e}}).done((function(e){lead_response_data=e})):$.ajax({url:"/pages/partial_lead.php",method:"POST",dataType:"json",data:{street_address:street_parsed[0],city:t,zipcode:o,state:r,county:i,lead_type:"seller",tags:settings.tagsData.join(","),form_source_url:window.location.href,source:l,recaptchaToken:e}}).done((function(e){lead_response_data=e}))}function showJustOneMoreThingModal(){$("#address_auto").val().trim()&&$("#street").val().trim()&&$("#zipcode").val().trim()?($("#hv-loading").modal("show"),setPartialLead(),formatPropertyTypeUrl(),get_property_data()):alert("Please enter a valid home address")}function authenticateSlipstream(e){$.ajax({url:apiUrl+"/ws/api/authenticate?license="+apikey,type:"GET",dataType:"json",async:e}).done((function(e){dataAuth=e}))}function setAddressVisible(){$(".address-loading-hv3").length>0&&($(".found-home-hv-3r").text("We found the home you requested!"),$(".address-content-hv3").css("opacity",1),$(".address-child-hv3").css("display","block"),$(".address-loading-hv3").css("opacity",0),$(".address-image-hv3").css("display","none"))}function get_property_data(){if($.ajax({url:propertyTypesUrl,type:"GET",dataType:"json"}).done((function(e){let a="";for(var t=e.propertyType.length-1;t>=0;t--){e.propertyType[t].toLowerCase().includes("residential")&&(a=e.propertyType[t]);var o='<li class="property_type_picked" pt_data="'+e.propertyType[t]+'">'+e.propertyType[t]+"</li>";$("#property_types_dropdown").append(o)}""!=a&&(propertyType=a,$("#label_property_type").text(a)),$(".property_type_picked").on("click",(function(){propertyType=$(this).attr("pt_data"),$("#label_property_type").text($(this).text())}))})),dataAuth.success){var e=$("#address_auto").val(),a=$("#city").val(),t=$("#state").val(),o=$("#zipcode").val();if((e=e.split(","))[0]&&a&&t&&o){var r=e[0]+"+"+a+"+"+t+"+"+o;let i=!1,l=!1;setTimeout((()=>{i=!0,l&&i&&setAddressVisible()}),5e3),$.ajax({url:apiUrl+"/ws/public-records/resolve?address="+r,type:"GET",dataType:"json",headers:{"HJI-Slipstream-Token":dataAuth.result.token}}).done((function(e){l=!0,$("#hvi_sq_feet").val(""),$("#hvi_beds").val(""),$("#hvi_bath_full").val(""),e.success&&(e.result.record.size&&$("#hvi_sq_feet").val(e.result.record.size),e.result.record.beds&&$("#hvi_beds").val(e.result.record.beds),e.result.record.baths&&$("#hvi_bath_full").val(e.result.record.baths.total),e.result.record.lotSize&&$("#hvi_land_full").val(parseFloat(e.result.record.lotSize.acres).toFixed(2))),l&&i&&setAddressVisible(),$("#map-box-container").length>0&&generateMap()}))}}}function generateMap(){$("#address_auto").val().trim(),$("#zipcode").val().trim();var e=$("#CmaLatitude").val(),a=$("#CmaLongitude").val();mapboxgl.accessToken="pk.eyJ1IjoiYmx1ZXJvb2YzNjAiLCJhIjoiY2prOHB1am40MDNlYjNwczBtN3V6ZG01dCJ9.IPRccV7flof-4CpZIbgcqg",initOfficesMap(new mapboxgl.Map({container:"map-box-container",style:"mapbox://styles/mapbox/light-v9",center:[a,e],zoom:11}),a,e)}function initOfficesMap(e,a,t){$("#new-home-value").on("hidden.bs.modal",(function(e){$(".map-box-container-cl").text("")})),$("#new-home-value").on("shown.bs.modal",(function(){e.resize(),e.on("load",(function(){e.loadImage("https://cdn1.brivityidx.com/assets/images/icons/map-marker.png",(function(o,r){if(o)throw o;e.addImage("custom-marker",r),e.addLayer({id:"find_marker",type:"symbol",source:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[a,t]}}]}},layout:{"icon-image":"custom-marker"}})}));var o=[a,t],r={steps:50,units:"miles"},i=turf.circle(o,1,r);$("#aria_label_miles").text("1 mi"),e.addLayer({id:"circle-fill",type:"fill",source:{type:"geojson",data:i},paint:{"fill-color":"rgba(0, 0, 0, 0.5)","fill-opacity":.5}}),$(".update_circle_miles").on("click",(function(){var a=parseInt($(this).attr("miles_n")),t=a;$("#aria_label_miles").text(a+" mi"),e.getLayer("circle-fill")&&(e.removeLayer("circle-fill"),e.removeSource("circle-fill")),e.getLayer("circle-fill")||(r={steps:50,units:"miles"},i=turf.circle(o,t,r),e.addLayer({id:"circle-fill",type:"fill",source:{type:"geojson",data:i},paint:{"fill-color":"rgba(0, 0, 0, 0.5)","fill-opacity":.5}}))}))}))})),$("#hv-loading").modal("hide"),$("#new-home-value").modal("show")}function compareWithMyHome_hvi(e){e.preventDefault(),e.stopImmediatePropagation();var a=$("#hv_name").val();a=a.split(" ");var t=$("#hv_email").val(),o=$("#hv_phone").val(),r=$("#hvi_beds").val(),i=$("#hvi_bath_full").val(),l=$("#hvi_sq_feet").val(),n=($("#hlead_intent").val()||"buyer").trim();r?$("#errorMessageBeds").text(""):$("#errorMessageBeds").text("The beds value missing."),i?$("#errorMessageBaths").text(""):$("#errorMessageBaths").text("The baths value missing."),$("#hvi_sq_feet").is(":visible")?l?$("#errorMessageSqft").text(""):$("#errorMessageSqft").text("The square footage is missing."):$("#hvi_sq_feet").val(0),propertyType?$("#errorMessageProp").text(""):$("#errorMessageProp").text("The property type is missing."),a[0]&&a[1]?$("#errorMessageName").text(""):$("#errorMessageName").text("Please enter your first and last name."),t?$("#errorMessageEmail").text(""):$("#errorMessageEmail").text("The email is missing."),o.length<9?$("#errorMessagePhone").text("The phone number is invalid."):$("#errorMessagePhone").text("");var s=$("#address_auto").val().split(","),d=window.location.href;$("#submit_hvi_form").attr("disabled",!0),$("#submit_hvi_form").text("Loading...");var _={site_id:0,phone:o,f_name:a[0],l_name:a[1],r_email:t,r_password:o.replace(/[^A-Z0-9]/gi,""),h_robot_field:"",form_source_url:d,action:$("#haction").val()||"",is_time_event_form:!0,time_event_type:"signup",lead_type:n,lead_id:lead_response_data.brivity_lead_id,tags:settings.tagsData.join(","),street_address:s[0],city:$("#city").val()||"",county:$("#county").val()||"",locality:$("#state").val()||"",postal_code:$("#zipcode").val()||""};if(!(a&&t&&o&&i&&r&&l&&propertyType))return alert("The form is incomplete"),$("#submit_hvi_form").attr("disabled",!1),$("#submit_hvi_form").text("Show my home value"),!1;$.ajax({url:"/pages/is_logged.php",data:{user_info:"yes"},method:"POST",dataType:"json"}).done((function(e){1==e.logged?(lead_response_data=e.lead_data,showHomevalueData(globalConfig.reportType)):loginProcess(t,o,_)}))}function compareWithMyHome_hvi3(e){e.preventDefault(),e.stopImmediatePropagation();var a=$("#hv_fname").val(),t=$("#hv_lname").val(),o=$("#hv_email").val(),r=$("#hv_phone").val(),i=($("#hlead_intent").val()||"buyer").trim(),l=$("#address_auto").val().split(","),n=window.location.href;$("#submit_hvi_form3").attr("disabled",!0),$("#submit_hvi_form3").text("Loading...");var s={site_id:0,phone:r,f_name:a,l_name:t,r_email:o,r_password:r.replace(/[^A-Z0-9]/gi,""),h_robot_field:"",form_source_url:n,action:$("#haction").val()||"",is_time_event_form:!0,time_event_type:"signup",lead_type:i,lead_id:lead_response_data?lead_response_data.brivity_lead_id:"",tags:settings.tagsData.join(","),street_address:l[0],city:$("#city").val()||"",county:$("#county").val()||"",locality:$("#state").val()||"",postal_code:$("#zipcode").val()||""};if(!(a&&t&&o&&r))return alert("The form is incomplete"),$("#submit_hvi_form3").attr("disabled",!1),$("#submit_hvi_form3").text("Access Now!"),!1;$.ajax({url:"/pages/is_logged.php",data:{user_info:"yes"},method:"POST",dataType:"json"}).done((function(e){1==e.logged?(lead_response_data=e.lead_data,showHomevalueData(globalConfig.reportType)):loginProcess(o,r,s)}))}function loginProcess(e,a,t){var o={login_form_email:e,login_form_password:a};$.ajax({url:"/pages/login.php",data:o,method:"POST",dataType:"json"}).done((function(a,o,r){if(1==a.status){var i=r.getResponseHeader("Authorization");i&&localStorage.setItem("authorization",i),afterAuth(a.user_fname,a.user_lname,e,a.agent||null,a.extra_data||{}),$.ajax({url:"/pages/is_logged.php",data:{user_info:"yes"},method:"POST",dataType:"json"}).done((function(e){1==e.logged?(lead_response_data=e.lead_data,showHomevalueData(globalConfig.reportType)):signupProcess(t)}))}else signupProcess(t)}))}function signupProcess(e){const a=window.location.search;new URLSearchParams(a).has("utm_source")&&(e.source="brivity_valuations",e.tags+=""===e.tags?"Viewed AVM":",Viewed AVM");let t=getHomevalueData(globalConfig.reportType);t.notification&&(e.extra={address:t.notification.address||"",county:t.notification.county||"",property_type:t.notification.propertyType||"",search_area:t.notification.searchArea||"",year:t.notification.year||"",acreage:t.notification.acreage||"",square_feet:t.notification.squareFeet||"",bed:t.notification.bed||"",bath:t.notification.bath||"",garage:t.notification.garage||"",subject:t.notification.subject||"",search_link:t.notification.searchLink||"",home_value:!0}),"undefined"!=typeof grecaptcha&&grecaptcha.ready((function(){grecaptcha.execute("6LfNOsoUAAAAAKTst6hjCdK0tmeiA4GVzqBjwScC",{action:"share_home_with_agent"}).then((function(a){e.recaptchaToken=a,$.ajax({url:"/pages/signup_with_recaptcha.php",data:e,method:"POST",dataType:"json"}).done((function(e,a,o){if(e.status||1!=e.msg_code){var r=o.getResponseHeader("Authorization");r&&localStorage.setItem("authorization",r),showHomevalueData(globalConfig.reportType)}else loginProcess(hv_email,hv_phone,t)}))}))}))}function getHomevalueData(e=""){let a={},t="/";if(""!=$("#state").val()&&null!=$("#state").val()){t+=$("#state").val().toUpperCase()+"/"}if(""!=$("#city").val()&&null!=$("#city").val()){t+=$("#city").val().toLowerCase()+"/"}if(t+=""!=$("#zipcode").val()&&null!=$("#zipcode").val()?$("#zipcode").val()+"/":"",""!=$("#address_auto").val()&&null!=$("#address_auto").val()){t+=replaceSpecialChars($("#address_auto").val().toLowerCase().split(",")[0])}const o=window.location.search,r=new URLSearchParams(o);if(r.has("utm_source")&&(t+="?utm_source="+r.get("utm_source")),""!=$("#aria_label_miles").text()&&null!=$("#aria_label_miles").text()){let e=$("#aria_label_miles").text().replace(" mi","");t+="#distance="+e,a.searchArea=e}if($("#hvi_sq_feet").val()>0||""!=$("#hvi_sq_feet").val()&&null!=$("#hvi_sq_feet").val()){let e=$("#hvi_sq_feet").val();t+="&sqfeet="+e,a.squareFeet=e}if($("#hvi_beds").val()>0||""!=$("#hvi_beds").val()&&null!=$("#hvi_beds").val()){let e=$("#hvi_beds").val();t+="&beds="+e,a.bed=e}if($("#hvi_bath_full").val()>0||""!=$("#hvi_bath_full").val()&&null!=$("#hvi_bath_full").val()){let e=$("#hvi_bath_full").val();t+="&bathrooms="+e,a.bath=e}if(time_to_sold&&(t+="&sold="+time_to_sold),propertyType&&(t+="&propertyType="+propertyType),t+="&lat="+$("#CmaLatitude").val()+"&lng="+$("#CmaLongitude").val(),t+="&size=500",$("#hvi_land_full").val()>0||""!=$("#hvi_land_full").val()&&null!=$("#hvi_land_full").val()){t+="&acreage="+$("#hvi_land_full").val()}return""!=e&&(t+="&reportType="+e),a.county=$("#county").val(),a.address=$("#address_auto").val(),a.searchLink=window.location.origin+"/homes-for-sale/comparables"+t,{redirection:"/homes-for-sale/comparables"+t,notification:a}}function showHomevalueData(e){let a=getHomevalueData(e);homeValueNotification(a.notification,a.redirection)}function execute_homevalue_report(){let e=getHomevalueData();homeValueNotification(e.notification,e.redirection)}function execute_homevalue_simple_report(){if(searchPropertiesSimpleReport(),globalConfig.agent_message?$(".agent_msg").text(globalConfig.agent_message):$(".agent_msg").text("I'm putting your full report together now! You can contact me now if you need anything."),agent_data.agent_fname){var e=agent_data.agent_fname+" "+agent_data.agent_lname;$("h3.agent-name").text(e),$("span.agent-name").text(" "+agent_data.agent_fname)}agent_data.agent_email&&($(".agent-email-a").attr("href","mailto:"+agent_data.agent_email),$(".agent-email").text(agent_data.agent_email)),agent_data.agent_phone&&($(".agent-phone-a").attr("href","tel:"+agent_data.agent_phone),$(".agent-phone").text(agent_data.agent_phone)),agent_data.agent_photo&&$(".team-agent-img").css("background-image","url("+agent_data.agent_photo+")")}function execute_homevalue_no_report(){if($("#new-home-value").modal("hide"),$("#hv-no-report").modal("show"),globalConfig.report_headline?$(".no_report_headline").text(globalConfig.report_headline):$(".no_report_headline").text("Your report is on the way"),globalConfig.report_sub_headline?$(".no_report_subheadline").text(globalConfig.report_sub_headline):$(".no_report_subheadline").text("We'll email your report within 24 hrs."),globalConfig.agent_message?$(".agent_msg").text(globalConfig.agent_message):$(".agent_msg").text("I'm putting your full report together now! You can contact me now if you need anything."),agent_data.agent_fname){var e=agent_data.agent_fname+" "+agent_data.agent_lname;$("span.agent-name").text(e),$("a.no_report_email_btn").text("Email "+agent_data.agent_fname)}agent_data.agent_email&&$("a.no_report_email").attr("href","mailto:"+agent_data.agent_email),agent_data.agent_phone&&$("a.no_report_telephone").attr("href","tel:"+agent_data.agent_phone)}function searchPropertiesSimpleReport(e,a){var t={},o=[],r=settings.mlsIds,i=$("#CmaLatitude").val(),l=$("#CmaLongitude").val();t.mlsId=r,t.status="3|2|1",t.q_limit=1e3,t.q_offset=0,t.location="("+i+","+l+"),3.5",t.q_include_total_count=!1,ajaxConf={url:"/pages/search.php",method:"POST",data:t,dataType:"json"};var n=$.ajax(ajaxConf).done((function(e){$.each(e.listings,(function(e,a){priceList.push(a.price)}))}));o.push(n),$.when.apply(null,o).done((function(){for(var e=0,a=priceList.length-1;a>=0;a--)e+=priceList[a];e/=priceList.length,minPrice=formatNumber(parseInt(.9*e)),maxPrice=formatNumber(parseInt(1.1*e)),$("#min_val_estimate").text("$"+minPrice),$("#max_val_estimate").text("$"+maxPrice),$("#new-home-value").modal("hide"),$("#popup-simple-rpt").modal("show")}))}function formatNumber(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}function isNumber(e,a){var t=e.which?e.which:event.keyCode;return 45==t&&-1==$(a).val().indexOf("-")||46==t&&-1==$(a).val().indexOf(".")||!(t<48||t>57)}function replaceSpecialChars(e){return e=e.replace("/","_")}-1==window.location.href.indexOf("sitebuilder")&&$(document).ready((function(){globalConfig=settings.homeValueData,localStorage.setItem("BlockConfig",JSON.stringify(globalConfig)),$("#errorMessage").text("");var e=getUrlParameter("search_address"),a=getUrlParameter("address_auto"),t=getUrlParameter("street"),o=getUrlParameter("city"),r=getUrlParameter("state"),i=getUrlParameter("zipcode"),l=getUrlParameter("latitude"),n=getUrlParameter("longitude");e&&a&&t&&o&&r&&i&&l&&n?(authenticateSlipstream(!1),$("#search_address").val(e),$("#address_auto").val(a),$("#street").val(t),$("#city").val(o),$("#state").val(r),$("#zipcode").val(i),$("#CmaLatitude").val(l),$("#CmaLongitude").val(n),showJustOneMoreThingModal()):authenticateSlipstream(!0),$.ajax({url:"/pages/get_agent.php",method:"GET",dataType:"json"}).done((function(e){agent_data=e.data})),$.ajax({url:"/pages/is_logged.php",data:{user_info:"yes"},method:"POST",dataType:"json"}).done((function(e){1==e.logged&&void 0!==(lead_response_data=e.lead_data)&&($("#hv_name").val(e.lead_data.first_name+" "+e.lead_data.last_name),$("#hv_fname").val(e.lead_data.first_name),$("#hv_lname").val(e.lead_data.last_name),$("#hv_email").val(e.lead_data.email),$("#hv_phone").val(e.lead_data.phone)),handleFindOutClickEvent(!1)})),$("#hvi_background").show(),$("#submit_hvi_form").on("click",compareWithMyHome_hvi),$("#submit_hvi_form3").on("click",compareWithMyHome_hvi3),$(".time_to_sold").on("click",(function(){time_to_sold=$(this).attr("tts"),$("#label_timeline_sold").text($(this).text())})),$("#hvi_land_full").keypress((function(e){return isNumber(e,this)})),$("#hvi_land_full").on("change",(function(){this.value=parseFloat(this.value).toFixed(2)}))})),$("#homeValueSearchAddress").on("click",(function(){showJustOneMoreThingModal()})),$(".home-value-contact").on("click",(function(){$("#contact_agent_full_name").val(lead_response_data.first_name+" "+lead_response_data.last_name),$("#contact_agent_email_address").val(lead_response_data.email),$("#contact_agent_phone_number").val(lead_response_data.phone),$("#popup-simple-rpt").modal("hide"),$("#home-value-contact").modal("show")}));