var isLoggedChecked=!1,askingToken=!1,changingPassword=!1,isLoggedIn=!1,reactGoogleLogInEmail="",reactLoginPhoneNumber="",reactLoginName="";if("undefined"==typeof toast){}function reactIsloggedinCheckFalse(){isLoggedIn=!1,$(".alterraCustomZipCode").find("#alterraCustomZipCodeClick").trigger("click")}function reactIsloggedinCheckTrue(){isLoggedIn=!0}function activateThanks(){$("body").trigger("sayThanks","The email has been sent")}function reactSendContactInfo(e,a,t,o,i){var n={time_event_type:"contact_form_block",h_robot_field:"",contact_fname:e,contact_lname:a,contact_email:t,contact_phone:o,contact_message:i,form_source_url:window.location.href};$.ajax({url:"/pages/contact.php",data:n,method:"POST",dataType:"json"}).done((function(e){$("body").trigger("sayThanks","The email has been sent")}))}const checkIfTokenExpired=()=>{const e=localStorage.getItem("authorization");if(!e)return!1;if(e){const a=JSON.parse(window.atob(e.split(".")[1]));if(Date.now()>=1e3*a.exp)return!1}return!0};function statusChangeCallback(e){console.log("statusChangeCallback"),console.log(e),"connected"===e.status&&(e.authResponse?(console.log("Welcome!  Fetching your information.... "),FB.api("/me",{fields:"first_name,last_name,email,id"},(function(e){var a="first_name"in e?e.first_name:"null",t="last_name"in e?e.last_name:"null",o="id"in e?e.id:"null",i="email"in e?e.email:"null";reactGoogleLogInEmail=e.email,reactLoginName=e.first_name+" "+e.last_name,reactIsloggedinCheckFalse(),doLogin("facebook",{email:i,fname:a,lname:t,fbid:o})}))):console.log("User cancelled login or did not fully authorize."))}function userLogOut(e){$.ajax({url:"/pages/logout.php",dataType:"json"}).done((function(a){1==a.status&&($("#huser_id").val("").trigger("change"),$("#not-logged-in").show(),$("#logged-in").hide(),$(".login-ss").show(),$(".create-ss").hide(),$(".favoritesCount").html("0"),$(".savedSearchesCount").html("0"),$("#hfavorites").val(""),$("#haction").val(""),localStorage.removeItem("authorization"),"facebook"==a.loginType&&facebookLogout(),"gmail"==a.loginType&&signOutGmail(),window.location.hash&&window.location.href.indexOf("/search")>7?doFullSearch(!1,!1,1):-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables")&&($("#listing_alert_sendbtn").hide(),$("#listing_alert_signup_sendbtn").show(),$("#favLink").attr("onclick","openSignup()"),$("#favIcon").addClass("fa-heart-o"),$("#favIcon").removeClass("fa-heart"),$("#name").val(""),$("#email").val(""),$("#schedule_phone").val(""),$("#contact_agent_name").val(""),$("#contact_agent_email").val(""),$("#contact_agent_phone").val(""),$("#contact_agent_full_name").val(""),$("#contact_agent_email_address").val(""),$("#contact_agent_phone_number").val("")),"function"==typeof e&&e())}))}function facebookLogout(){FB.logout((function(e){console.log(e)}))}function checkLoginState(){FB.getLoginStatus((function(e){statusChangeCallback(e)}))}function fbLogin(){global_fb=!0,FB.login((function(e){statusChangeCallback(e)}),{scope:"email"})}function onSignIn(e){console.log("googlecheck"),reactIsloggedinCheckTrue();var a=e.getBasicProfile(),t=a.getName().split(" ");reactLoginName=a.getName(),reactGoogleLogInEmail=a.getEmail(),doLogin("gmail",{email:a.getEmail(),fname:t[0],lname:t[1],gid:a.getId()}),reactIsloggedinCheckFalse()}function signOutGmail(){gapi.auth2.getAuthInstance().signOut().then((function(){console.log("User signed out.")}))}function trackSiteVisit(){$.ajax({url:"/pages/site_visits.php",dataType:"json"}).done((function(e){}))}function isOpenhouse(){let e=window.location.pathname+window.location.search;return e.indexOf("/openvirtual")>-1||e.indexOf("/openlight")>-1||e.indexOf("/openfull")>-1||e.indexOf("/openbroker")>-1||e.indexOf("/openhouse")>-1}function setCookieForMinutes(e,a,t){var o="";if(t){var i=new Date;i.setTime(i.getTime()+60*t*1e3),o="; expires="+i.toUTCString()}document.cookie=e+"="+(a||"")+o+"; path=/"}function getCookieByName(e){for(var a=e+"=",t=decodeURIComponent(document.cookie).split(";"),o=0;o<t.length;o++){for(var i=t[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(a))return i.substring(a.length,i.length)}return""}function showGoogleOneTap(e){if(!isOpenhouse()){let a={client_id:"727134128516-d9kdb4teh9odhn73psvh5cvpkncmut3m.apps.googleusercontent.com",callback:handleOnetapResponse};e?a.prompt_parent_id="credential_picker_container_centered":a.cancel_on_tap_outside=!1,google.accounts.id.initialize(a),e?google.accounts.id.prompt((e=>{e.isNotDisplayed()?showSignupModal():e.isSkippedMoment()?$("#credential_picker_container_centered").hide():$("#credential_picker_container_centered").toggle()})):google.accounts.id.prompt()}}function _isPropertyDetails3(){return $("property-details").length>0}function showSignupModal(){$("property-details");$(".tab-content > #signin").removeClass("active"),$(".tab-content > #signin").removeClass("in"),$(".tab-content > #create").addClass("active in"),$("#sign-up-modal").modal("show")}function showLoginModal(){const e=$("property-details");if(_isPropertyDetails3())return e.attr("signUpErrorMessage",!0),e.attr("showSignUpModal",!0);$(".tab-content > #create").removeClass("active"),$(".tab-content > #create").removeClass("in"),$(".tab-content > #signin").addClass("active in"),$("#sign-up-modal").modal("show")}function handleOnetapResponse(e){e.referrer=window.location.href,$.ajax({url:"/pages/login_google_onetap.php",data:e,method:"POST",dataType:"json"}).done((function(e){if(e.status){var a=e.email;$("#huser_id").val(e.user_id).trigger("change"),$("#update_user_email").val(a),processLoggedUser()}}))}function replace_all(e,a,t){return e.split(a).join(t)}function parseAreasCityBlockContent(e){var a="";return e&&e.length&&e.forEach((function(e){a+='<div class="col-sm-12 col-md-4 margin-bottom-20"><ul class="editContent list-group">',e.forEach((function(e){var t=encodeURIComponent(e.city);a+='<li class="list-group-item" href=""><span class="badge"><a class="pull-left" data-toggle="tooltip" data-placement="left" title="View Market Report" href="/sitemap/city/'+e.state+"/"+t+'"><i class="ss-barchart"></i></a><a class="listing-number" data-toggle="tooltip" data-placement="left" title="Search Listings" href="/search#?multi_search='+encodeURIComponent(e.city)+'&multi_cat=City">'+e.total+'</a></span><a href="/sitemap/city/'+e.state+"/"+t+'">'+e.city+", "+e.state+"</a></li>"})),a+="</ul></div>"})),a}function getUtmParams(){let e={};const a=window.location.search,t=new URLSearchParams(a);return t.has("utm_source")&&(e["retarget-utm"]={utm_source:t.get("utm_source")},(window.location.search.indexOf("ads_auto_login=retarget_brivity_facebook_ads")>0||window.location.search.indexOf("brivity_connect=ads-remarket")>0||window.location.search.indexOf("brivity_leads=brivity_ads")>0)&&(e["retarget-utm"].ads_auto_login="retarget_brivity_facebook_ads",e["retarget-utm"].url=window.location.href,""!==document.referrer&&(e["retarget-utm"].referrer=document.referrer),t.has("utm_medium")&&(e["retarget-utm"].utm_medium=t.get("utm_medium")),t.has("utm_campaign")&&(e["retarget-utm"].utm_campaign=t.get("utm_campaign")),t.has("utm_type")&&(e["retarget-utm"].utm_type=t.get("utm_type")))),e}function processLoggedUser(){let e=getUtmParams();jQuery.isEmptyObject(e)||(e.user_info="yes",$.ajax({url:"/pages/is_logged.php",data:e,method:"POST",dataType:"json"}).done((function(e){e.logged&&(null!=e.favorites&&$(".favoritesCount").html(e.favorites||0),null!=e.saved_searches&&$(".savedSearchesCount").html(e.saved_searches||0),afterAuth(e.lead_data.first_name,e.lead_data.last_name,e.lead_data.email),propertyDetailsTopBar(e))})))}function loginLastFacebookLeadGenerated(){$.ajax({url:"/pages/login_facebook_leadgen.php",method:"GET",dataType:"json"}).done((function(e){if(e.status){var a=e.email;$("#huser_id").val(e.user_id).trigger("change"),$("#update_user_email").val(a),processLoggedUser()}}))}function doLogin(e,a){var t={login_form_email:$("#search_username").val(),login_form_password:$("#search_password").val()};null!=e&&(t.typeLogin=e,t.accountData=a,t.form_source_url=window.location.href);var o=!1;if(window.location.search.indexOf("ads_auto_login=retarget_brivity_facebook_ads")>0||window.location.search.indexOf("brivity_connect=ads-remarket")>0||window.location.search.indexOf("brivity_leads=brivity_ads")>0){const e=window.location.search,a=new URLSearchParams(e);o=!0,a.has("utm_source")&&(t["retarget-utm"]={utm_source:a.get("utm_source"),ads_auto_login:"retarget_brivity_facebook_ads",url:window.location.href},a.has("utm_medium")&&(t["retarget-utm"].utm_medium=a.get("utm_medium")),a.has("utm_campaign")&&(t["retarget-utm"].utm_campaign=a.get("utm_campaign")),a.has("utm_type")&&(t["retarget-utm"].utm_type=a.get("utm_type")))}if("facebook"==e&&($("#signupForm input, #signin input").attr("disabled",!0),$(".frc-btn-facebook").attr("disabled",!0),$(".frc-btn-facebook div span").text("Logging in..."),$("#force-social-registration").length&&($("#force-social-registration").data("bs.modal")||{}).isShown||$("#force-search-registration").length&&($("#force-search-registration").data("bs.modal")||{}).isShown||$("#force-combine-registration").length&&($("#force-combine-registration").data("bs.modal")||{}).isShown))if(t.extra={referrer:getQueryParamByName("share")},t.form_source_url=window.location.href,$("#frg-h-tags").length&&$("#frg-h-tags").val().trim()&&(t.tags=$("#frg-h-tags").val().trim()),$("#force-social-registration").length&&($("#force-social-registration").data("bs.modal")||{}).isShown)t.time_event_type="forced_registration_property_page_social";else if($("#force-combine-registration").length&&($("#force-combine-registration").data("bs.modal")||{}).isShown)t.time_event_type="forced_registration_property_page_combined";else if($("#force-search-registration").length&&($("#force-search-registration").data("bs.modal")||{}).isShown){t.time_event_type="forced_registration_search_page_combined";var i="",n=parseInt($("#min_bedrooms").val().trim()),r=parseInt($("#max_bedrooms").val().trim()),s=parseInt($("#min_bathrooms").val().trim()),l=parseInt($("#max_bathrooms").val().trim()),c=parseInt($("#min_price").val().trim()),d=parseInt($("#max_price").val().trim());$("#hmulti_search").val().trim()&&(i+=$("#hmulti_search").val().trim()),(n||r)&&(i+=(i?", ":"")+(n&&r?n+"-"+r:n?n+"+":"<"+r)+" beds"),(s||l)&&(i+=(i?", ":"")+(s&&l?s+"-"+l:s?s+"+":"<"+l)+" baths"),(c||d)&&(i+=(i?", ":"")+(c&&d?formatPriceUserFriendly(c)+" - "+formatPriceUserFriendly(d):c?formatPriceUserFriendly(c)+"+":"<"+formatPriceUserFriendly(d))),i&&(t.extra.criteria=i),t.extra.search_url=window.location.origin+"/search"+window.location.hash}$.ajax({url:"/pages/login.php",data:t,method:"POST",dataType:"json"}).done((function(t,i,n){if($("#loginBtn").text("Login to My Account"),$("#loginBtn").prop("disabled",!1),1==t.status){o&&$("#facebook-login-modal").modal("hide");var r=n.getResponseHeader("Authorization");r&&localStorage.setItem("authorization",r),localStorage.setItem("uuid",t.uuid);var s={fname:t.user_fname?t.user_fname:a&&a.fname?a.fname:"",lname:t.user_lname?t.user_lname:a&&a.lname?a.lname:"",email:$("#search_username").val()?$("#search_username").val():a&&a.email?a.email:""};_isPropertyDetails3()&&($("property-details").attr("user",JSON.stringify({...t,...s})),$("property-details").attr("isLogged",!0)),$("#huser_id").val(t.user_id).trigger("change"),$("#search_password").val(""),$(".favoritesCount").html(t.favorites?t.favorites:"0"),$(".savedSearchesCount").html(t.saved_searches?t.saved_searches:"0"),afterAuth(s.fname,s.lname,s.email,t.agent||null,t.extra_data||{}),insertUserActivity("user_logged_in"),$("#haction").length&&""!=$("#haction").val()?"pdetails-save-favorite"==$("#haction").val()?($("#haction").val(""),saveFavorite($("#hmls_id").val()+"_"+$("#hmls_num").val(),$("#hmls_num").val(),$("#hblossorid").val(),$("#hprice").val())):doAction():$("#h_action").length&&""!=$("#h_action").val()?doAction():-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables")?($("#favLink").attr("onclick",'saveFavorite("'+$("#hmls_id").val()+"_"+$("#hmls_num").val()+'","'+$("#hmls_num").val()+'")'),favoritesPropertyDetails()):-1!==window.location.href.indexOf("/homes-for-sale/")&&-1===window.location.href.indexOf("/homes-for-sale/comparables")&&signupMonthly(),"facebook"!=e&&"gmail"!=e||(t.new_user||void 0!==t.phone&&!t.phone)&&($("#confirm_phone").mask("(999) 999-9999"),$("#phone-confirm-modal").modal({backdrop:"static",keyboard:!1}))}else $("#loginErrorMessage").length?($("#loginErrorMessage").text(t.msg),$("#loginErrorMessage").css({display:"block"}),setTimeout((function(){$("#loginErrorMessage").css({display:"none"})}),1e4)):alert(t.msg);"facebook"==e&&($("#signupForm input, #signin input").removeAttr("disabled"),$(".frc-btn-facebook").removeAttr("disabled"),$(".frc-btn-facebook div span").text("Continue with Facebook"))}))}function favoritesPropertyDetails(){if($("#bluecombo_url").val()){var e=$("#hmls_num").val();$.ajax({url:"/pages/get_favorites.php",method:"POST",dataType:"json"}).done((function(a){for(var t=0;t<a.favorites.length;t++)e==a.favorites[t].mls_num&&($("#favIcon").removeClass("fa-heart-o"),$("#favIcon").addClass("fa-heart"),$("#favIcon").addClass("savedProperty"))}))}}function propertyDetailsTopBar(e){var a=0,t=0,o="",i="";if(e.logged)a=e.user_id,e.uuid&&(t=e.uuid),e.lead_data.first_name&&(o=e.lead_data.first_name),e.lead_data.last_name&&(i=e.lead_data.last_name),$("#favLink").attr("onclick","saveFavorite('"+$("#hmls_id").val()+"_"+$("#hmls_num").val()+"','"+$("#hmls_num").val()+"')"),e.hasOwnProperty("lead_data")&&($("#name").val(e.lead_data.first_name+" "+e.lead_data.last_name),$("#email").val(e.lead_data.email),$("#schedule_phone").val(e.lead_data.phone),$("#contact_agent_name").val(e.lead_data.first_name+" "+e.lead_data.last_name),$("#contact_agent_email").val(e.lead_data.email),$("#contact_agent_phone").val(e.lead_data.phone),$("#contact_agent_full_name").val(e.lead_data.first_name+" "+e.lead_data.last_name),$("#contact_agent_email_address").val(e.lead_data.email),$("#contact_agent_phone_number").val(e.lead_data.phone)),favoritesPropertyDetails();else{var n=$("#hforced_registration").val();if(n>-1&&-1===window.location.href.indexOf("ignore-forced-registration=true")&&window.location.href.indexOf("/combined")<8&&window.location.href.indexOf("/social")<8&&window.location.href.indexOf("/share")<8&&window.location.href.indexOf("/open")<8&&window.location.href.indexOf("/light")<8&&window.location.href.indexOf("/virtual")<8&&window.location.href.indexOf("/full")<8&&window.location.href.indexOf("/landing")<8){var r=readCookie("forcedRegistrationTries");createCookie("forcedRegistrationTries",r?parseInt(r)+1:1,90),(r=parseInt(readCookie("forcedRegistrationTries")))>n&&($("#signupCancelBtn").hide(),$("#sign-up-modal").modal({backdrop:"static",keyboard:!1}),$("#is_forced_registration").val("1"))}}if($("#hblossorid").val()){var s={address:$("#hstreet_address").val(),photo_url:$("#hmain_photo").val(),type:"property_view",uuid:t,lead_id:a,blossor_id:$("#hblossorid").val(),price:$("#hprice").val(),url:window.location.href,property_id:$("#hpropertyid").val(),beds:$("#hbeds").val(),baths:$("#hbaths").val(),sqft:$("#hsqfeet").val(),city:$("#hcity").val(),zip:$("#hzip").val(),state:$("#hstate").val(),neighborhood:$("#hneighborhood").val()};""!=o&&(s.first_name=o),""!=i&&(s.last_name=i),$.ajax({url:"/pages/analytics.php",data:s,dataType:"json"}).done((function(e){trackSiteVisit()}))}}function loadSavedSearches(){$("#user_data").html('<img src="https://cdn1.brivityidx.com/assets/images/spinner.gif" alt="loading">'),$.ajax({url:"/pages/get_saved_searches.php?return_type=html",dataType:"json"}).done((function(e){if($("#saved-searches-loading").hide(),$("#saved-searches-container").show(),1==e.status)if(""==e.searches)e.searches="<h5>Click on the 'Save Search' button to save your search and begin receiving listing alerts.</h5>",$("#user_data").html(e.searches);else{$("#user_data").html('<div class="savedsearch-slick"></div>'),slickSettings(".savedsearch-slick");for(var a=e.searches.split("<div id="),t=0;t<=a.length-1;t++)""!=a[t]&&(a[t]=a[t].replace("deleteSavedSearch(","deleteSavedSearch("+(t-1)+","),$(".savedsearch-slick").slick("slickAdd","<div id="+a[t]))}}))}function deleteSavedSearch(e,a){$.ajax({url:"/pages/delete_saved_search.php?search_id="+a,dataType:"json"}).done((function(t){if(1==t.status){$(".savedsearch-slick").slick("slickRemove",e);var o=parseInt($(".savedSearchesCount").html());$(".savedSearchesCount").html(o-1),insertUserActivity("search_save_removed",null,{search_id:a})}else alert(t.msg)}))}function runSavedSearch(e){window.location.href.indexOf("/search")>7?(console.log($("#ss_data_"+e).val()),$(".save_search_link").trigger("click"),setUIFromHash($("#ss_data_"+e).val()),doFullSearch(!1,!0,1)):window.location="/search"+$("#ss_data_"+e).val()}function saveSearch(e,a){var t={},o=!0;if(window.location.href.indexOf("/search")<8){if(o=!1,""==$("#huser_id").val())return void console.log("not logged in");var i=$("#hcity").val()+", "+$("#hstate").val(),n="";if(void 0!==e)n="&price="+e.min+":"+e.max,e.min,e.max;else if($("#hsale_price").val()){var r=parseInt($("#hsale_price").val());n="&price="+.8*r+":"+1.2*r}t={hash:"newsearchhash#?q_limit=36&mlsId="+$("#hmls_id").val()+"&multi_search="+i+"&multi_cat=CityState&q_sort=createdAt-&q_offset=0"+n,multi_search:$("#hmulti_search").val(),mlsid:$("#hmls_id").val(),prefix:"none",searchName:i,multi_search:i,queue_request:!0}}else{var s=$("#ss-name").val(),l=$("#frequency").val();""==$("#ss-name").val()&&(o=!1,""!=$("#hmulti_search").val()?(s=$("#hmulti_search").val(),$("#min_price").val()>0&&$("#max_price").val()>0?s+=" $"+$("#min_price").val()+" - $"+$("#max_price").val():$("#min_price").val()>0?s+=" $"+$("#min_price").val():$("#max_price").val()>0&&(s+=" $"+$("#max_price").val())):s="Your Home Search");"Address"!=$("#hmulti_cat").val()&&"mlsNum"!=$("#hmulti_cat").val()||-1!==window.location.hash.indexOf("q_photos_available")||"&q_photos_available=false";const e=$("#mls_list").val().split("|"),a=[];e.forEach((e=>{a.push(Number(e))}));let i=[],n=[],r=[],d=[],m=[],h=[],u=[],g=[],p=[],f=[],v="";const _=$("#hpropertyType").val().split("|").map((e=>e.trim())),b=$("#hmulti_search").val().split("|").map((e=>e.trim()));$("#hmulti_cat").val().split("|").map((e=>e.trim())).forEach(((e,a)=>{if("CityState"===e){const e=b[a].split(",").map((e=>e.trim()));i.push({city:e[0],state:e[1]})}if("Address"===e&&(v||(v=b[a])),"Zip"===e&&r.push(b[a]),"NeighborhoodCityState"===e){const e=b[a].split(",").map((e=>e.trim()));d.push({neighborhood:e[0],city:e[1],state:e[2]})}if("High School"===e&&u.push(b[a]),"Middle School"===e&&h.push(b[a]),"Elementary School"===e&&m.push(b[a]),"CountyState"===e){const e=b[a].split(",").map((e=>e.trim()));n.push({county:e[0],state:e[1]})}"School District"===e&&g.push(b[a]),"MLS"===e&&p.push(b[a]),"Area"===e&&f.push(b[a])}));var c=t={mlsIds:a,source:"idx",frequency:l,searchName:s,leadId:localStorage.getItem("uuid"),activeForEmails:!0,activeForAppNotifications:!0,bathsMin:$("#min_bathrooms").val()>0?Number($("#min_bathrooms").val()):null,bathsMax:$("#max_bathrooms").val()>0?Number($("#max_bathrooms").val()):null,bedsMin:$("#min_bedrooms").val()>0?Number($("#min_bedrooms").val()):null,bedsMax:$("#max_bedrooms").val()>0?Number($("#max_bedrooms").val()):null,sqFtMin:$("#min_sqt").val()>0?Number($("#min_sqt").val()):null,sqFtMax:$("#max_sqt").val()>0?Number($("#max_sqt").val()):null,priceMin:$("#min_price").val()>0?Number($("#min_price").val()):null,priceMax:$("#max_price").val()>0?Number($("#max_price").val()):null,yearMin:$("#min_year").val()>0?Number($("#min_year").val()):null,yearMax:$("#max_year").val()>0?Number($("#max_year").val()):null,garageMin:$("#min_garage").val()>0?Number($("#min_garage").val()):null,lotSizeMin:$("#min_lot").val()>0?Number($("#min_lot").val()):null,lotSizeMax:$("#max_lot").val()>0?Number($("#max_lot").val()):null,streetAddress:v||null,schoolDistricts:g.length>0?g:null,elementarySchools:m.length>0?m:null,middleSchools:h.length>0?h:null,highSchools:u.length>0?u:null,cityStates:i.length>0?i:null,countyStates:n.length>0?n:null,postalCodes:r.length>0?r:null,neighborhoodCityStates:d.length>0?d:null,mlsNums:p.length>0?p:null,mlsAreas:f.length>0?f:null,propertyTypes:""!==_[0]?_:null}}if(""!=$("#hmulti_cat").val()&&"no_cat"!=$("#hmulti_cat").val()||window.location.hash.indexOf("polygon")>0){if(!checkIfTokenExpired())return void $("#sign-up-modal").modal("show");const e=localStorage.getItem("authorization");"undefined"!=typeof saveSearchModal&&saveSearchModal.toggleLoading(!0),fetch("https://brivity-home-middleware.production.brivity.com/listingAlerts/alert",{method:"POST",cache:"no-cache",headers:{Authorization:e,"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{if(e.alertId){$("#my-account").is(":visible")&&$("#my-account").hasClass("search-active")&&loadSavedSearches(),getSavedSearches(),o&&(toast&&toast.show("Search Saved."),toast||alert("Search Saved."),$("#ss-name").val(""),"undefined"!=typeof saveSearchModal?(saveSearchModal.hide(),saveSearchModal.toggleLoading(!1)):$("#create-ss").collapse("hide"));var a=parseInt($(".savedSearchesCount").html());$(".savedSearchesCount").html(a+1),insertUserActivity("search_save_added",null,c)}else toast&&toast.show("There was an issue saving this search. Please try again later.",!0),toast||alert("There was an issue saving this search. Please try again later.")}))}}function getSavedSearches(){$.ajax({url:"/pages/get_saved_searches.php",dataType:"json"}).done((function(e){1==e.status&&e.searches&&e.searches.mysearches&&(savedSearchesList=parseSavedSearches(e.searches.mysearches,!0))}))}function getRecommendedSearches(){$.ajax({url:"/pages/get_recommended_searches.php",dataType:"json"}).done((function(e){e&&e.searches&&e.searches.length&&(recommendedSearchesList=e.searches.map((function(e){return{label:e.search_name,value:e.search_name,url:e.search_url,category:"Popular Searches"}})))}))}function parseSavedSearches(e,a){if(e.length){var t=[];return $.each(e,(function(o){var i=this.search_name||"",n="";parseInt(this.bedrooms)&&(n+=(n?", ":"")+this.bedrooms+"+ beds"),parseInt(this.bathrooms)&&(n+=(n?", ":"")+parseInt(this.bathrooms)+"+ baths"),parseInt(this.max_price)&&parseInt(this.min_price)?n+=(n?", ":"")+formatPriceForList(this.min_price)+"-"+formatPriceForList(this.max_price):parseInt(this.max_price)?n+=(n?", ":"")+" <"+formatPriceForList(this.max_price):parseInt(this.min_price)&&(n+=(n?", ":"")+" >"+formatPriceForList(this.min_price)),i=i+((n||this.multi_search)&&a?": ":"")+this.multi_search+(this.multi_search&&n?" - ":"")+n,t.push({category:a?"Saved Searches":"",label:i,searchObj:this,previous_search:!a}),console.log("hello",e)})),t}}function formatPriceForList(e){return e<1e6&&e>0?"$"+(e=Math.floor(e/1e3))+"K":"$"+(e/=1e6).toFixed(2)+"M"}function slickSettings(e){$(e).slick({slidesToShow:3,slidesToScroll:3,dots:!0,responsive:[{breakpoint:478,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:1280,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1360,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1400,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1600,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1680,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1920,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:2048,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:2560,settings:{slidesToShow:6,slidesToScroll:6}}]})}function afterAuth(e,a,t,o,i){if($("#not-logged-in").hide(),$("#logged-in").show(),$("#huser_email").val(t),$("#huser_first_name").val(e),$("#huser_last_name").val(a),$(".topBarProfile .profileName").text("Hi "+e||"!"),o&&o.agent_phone?($(".topBarAgentPhoneLabel span").text(o.agent_phone).show(),$(".topBarAgentPhoneLabel").show(),$(".topBarAgentPhoneLabel").attr("href","tel:"+o.agent_phone.replace(/[^0-9.]/g,""))):$(".topBarAgentPhoneLabel").hide(),i&&i.image_url&&-1!=i.image_url.search("http")&&$("#site-registration-bar .topBarPic").attr("style",'background-image: url("'+i.image_url+'");'),$(".login-ss").hide(),$(".create-ss").show(),$("#sign-up-modal").modal?$("#sign-up-modal").modal("hide"):document.getElementById("signupCancelBtn").click(),-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables")&&($("#listing_alert_sendbtn").show(),$("#listing_alert_signup_sendbtn").hide(),$("#favLink").attr("onclick","openSignup()"),$("#favIcon").addClass("fa-heart-o"),$("#favIcon").removeClass("fa-heart"),$("#name").val(e+" "+a),$("#email").val(t),$("#contact_agent_name").val(e+" "+a),$("#contact_agent_email").val(t),$("#contact_agent_full_name").val(e+" "+a),$("#contact_agent_email_address").val(t)),-1!==window.location.href.indexOf("/homes-for-sale/comparables")){$("#findOutBtn").attr("data-target","#modal_subject_home"),"button"===$("#modal_subject_home").attr("caller")&&setTimeout((function(){$("#modal_subject_home").modal("show"),$("#modal_subject_home").removeAttr("caller")}),500),(r=(r=readCookie("searchAddressCache"))&&JSON.parse(r)||[])&&r.length&&(setPartialLead&&setPartialLead(r),eraseCookie("searchAddressCache"));var n=readCookie("homeValueNotificationData");(n=n&&JSON.parse(n)||{})&&n.address&&(homeValueNotification&&homeValueNotification(n),eraseCookie("homeValueNotificationData"))}else{var r;if("modal_subject_home"===$("#sign-up-modal").attr("callback-modal"))setTimeout((function(){$("#modal_subject_home").modal("show"),$("#sign-up-modal").removeAttr("callback-modal")}),500),(r=(r=readCookie("searchAddressCache"))&&JSON.parse(r)||[])&&r.length&&(setPartialLead&&setPartialLead(r),eraseCookie("searchAddressCache"))}$("#haction").val()&&"saveSearch-0"==$("#haction").val()&&($("#sv2-multi-search .range-end button.create-ss").trigger("click"),$("#haction").val(""))}function swapIcons(e,a){switch(e){case"save_search_link":$(".favorites_link").find("img").attr("src","https://cdn1.brivityidx.com/assets/images/icon/heart-w.svg"),a.attr("src","https://cdn1.brivityidx.com/assets/images/icon/search-w.svg"==a.attr("src")?"https://cdn1.brivityidx.com/assets/images/icon/x-circle-w.svg":"https://cdn1.brivityidx.com/assets/images/icon/search-w.svg");break;case"favorites_link":$(".save_search_link").find("img").attr("src","https://cdn1.brivityidx.com/assets/images/icon/search-w.svg"),a.attr("src","https://cdn1.brivityidx.com/assets/images/icon/heart-w.svg"==a.attr("src")?"https://cdn1.brivityidx.com/assets/images/icon/x-circle-w.svg":"https://cdn1.brivityidx.com/assets/images/icon/heart-w.svg")}}function saveFavorite(e,a,t,o,i,n,r,s,l,c,d,m,h,u,g,p,f,v,_,$){null==t?saveFavoritePdetails(e,a,p,f,v,_):saveFavoriteTopAndSearch(e,a,t,o,i,n,r,s,l,c,d,m,h,u,g,p,f,v,_,$)}function saveFavoritePdetails(e,a,t,o,i,n){var r={price:$("#hprice").val(),address:$("#hstreet_address").val(),photo_url:$("#hmain_photo").val(),lth:e,mls_num:a,blossor_id:$("#hblossorid").val(),url:window.location.href,beds:$("#hbeds").val(),baths:$("#hbaths").val(),sqft:$("#hsqfeet").val(),city:$("#hcity").val(),zip:$("#hzip").val(),state:$("#hstate").val(),neighborhood:$("#hneighborhood").val(),property_url:t,property_type:o,acreage:i,sqFeet:n};if(""!=$("#huser_first_name").val()&&(r.first_name=$("#huser_first_name").val()),""!=$("#huser_last_name").val()&&(r.last_name=$("#huser_last_name").val()),$("#add-prop-fav").hasClass("savedProperty"))$.ajax({url:"/pages/delete_favorites.php",data:r,dataType:"json"}).done((function(e){if(e.status){var a=parseInt($(".favoritesCount").html());$(".favoritesCount").html(a-1),$("#add-prop-fav").removeClass("savedProperty"),$("#add-prop-fav > svg").attr("fill","none"),insertUserActivity("favorite_property_removed_details",$("#hpropertyid").val())}}));else{$.ajax({url:"/pages/add_favorites.php",data:r,dataType:"json"}).done((function(e){if(e.status){var a=parseInt($(".favoritesCount").html());$(".favoritesCount").html(a+1),$("#add-prop-fav").addClass("savedProperty"),$("#add-prop-fav > svg").attr("fill","#E62117"),insertUserActivity("favorite_property_added_details",$("#hpropertyid").val())}})),new FbRealEstatePixelTracker({eventType:"InitiateCheckout",content_ids:[r.blossor_id?r.blossor_id:""]}).fireEvent()}}function saveFavoriteTopAndSearch(e,a,t,o,i,n,r,s,l,c,d,m,h,u,g,p,f,v,_,b){var w="."+e;a&&(w+="_m");var y={price:i,address:n,photo_url:u,lth:e,mls_num:t,blossor_id:o,url:window.location.href,beds:m,baths:d,sqft:h,city:r,zip:l,state:s,neighborhood:c,property_url:p,property_type:f,acreage:v,sqFeet:_};if(""!=$("#huser_first_name").val()&&(y.first_name=$("#huser_first_name").val()),""!=$("#huser_last_name").val()&&(y.last_name=$("#huser_last_name").val()),$(w).hasClass("savedProperty"))$.ajax({url:"/pages/delete_favorites.php",data:y,dataType:"json"}).done((function(o){if(o.status){null!=$("#hmls_num").val()&&t===$("#hmls_num").val()&&($("#add-prop-fav > svg").attr("fill","none"),$("#add-prop-fav").removeClass("savedProperty"));var i=parseInt($(".favoritesCount").html());if($(".favoritesCount").html(i-1),a&&$(w).css("opacity",.5),$(".favoriteBtn"+e).removeClass("save-property-active"),$(".favoriteBtn"+e+"> i").removeClass("save-property-active"),$(".favoriteBtn"+e).addClass("save-property"),$(".favoriteBtn"+e+" > i").removeClass("fa-heart"),$(".favoriteBtn"+e+" > i").addClass("fa-heart-o"),$(w).removeClass("savedProperty"),a&&($("."+e).removeClass("savedProperty"),$("#fav_"+e).remove()),$("#hfavorites").length)for(var n=$("#hfavorites").val().split(","),r="",s=0;s<n.length;s++)n[s]!=e&&(r+=n[s]+","),$("#hfavorites").val(r.substr(0,r.length-1));else $("#favIcon").removeClass("fa-heart"),$("#favIcon").removeClass("savedProperty"),$("#favIcon").addClass("fa-heart-o");insertUserActivity("favorite_property_removed",$("."+e+" .listing-image").attr("id"))}else alert(o.msg)}));else if(b){if(!checkIfTokenExpired())return void $("#sign-up-modal").modal("show");const S={blossor_id:o,image:[{id:0,uri:u}],price:i,address:n,city:r,state:s,postal_code:l,beds:m,baths:d,sqft:h};if($("#property-info").val(JSON.stringify(S)),$(`.${o} > i`).hasClass("fa-heart")){const C=JSON.parse($("#collection-info").val()),x=document.querySelector("place-removecollectionpopup");async function k(e){const a=await collectionsService.checkIfInCollection(e);$("#collection-info").val(JSON.stringify(a.data));for(const e in a.data)a.data[e]&&($(`.${e} > i`).addClass("fa-heart"),$(`.${e} > i`).removeClass("fa-heart-o"))}for(const T in C)T===o&&(1===C[T].length&&collectionsService?collectionsService.removePropertyFromCollection(C[T][0].collectionUUID,C[T][0].propertyUUID).then((e=>{let a=document.querySelector("place-copycollectionmodal"),t=JSON.parse(a.getAttribute("collections")),i=e.data.collectionUUID;collectionsService.getCollectionProperties(i,1,1).then((e=>{let o=t.findIndex((e=>e.id==i)),n=t[o];n.propertiesImages=[],e?.data?.properties&&n.propertiesImages.push({mainPhoto:e?.data?.properties[0]?.photos[0]?.url}),t[o]=n,a.setAttribute("collections",JSON.stringify(t))})),$(`.${o} > i`).removeClass("fa-heart"),$(`.${o} > i`).addClass("fa-heart-o"),k(JSON.parse($("#blossorID-info").val())),toast.show("Property removed from collection")})).catch((()=>{toast.show("There was an error, please try again later",!0)})):(x.setAttribute("collections",JSON.stringify(C[T])),$(".delete-property-parent").css("display","flex")))}else{if(localStorage.getItem("authorization")){$(".copy-collection-parent").css("display","flex");let O=document.querySelector("place-copycollectionmodal");O.setAttribute("style","display: flex;"),O.setAttribute("mls",JSON.stringify(S)),O.setAttribute("image_url",u)}else $("#sign-up-modal").modal("show")}}else{$.ajax({url:"/pages/add_favorites.php",data:y,dataType:"json"}).done((function(t){if(t.status){var p=parseInt($(".favoritesCount").html());if($(".favoritesCount").html(p+1),a&&$(w).css("opacity",1),$(".favoriteBtn"+e).addClass("save-property-active"),$(".favoriteBtn"+e).removeClass("save-property"),$(".favoriteBtn"+e+" > i").removeClass("fa-heart-o"),$(".favoriteBtn"+e+" > i").addClass("fa-heart"),$(w).addClass("savedProperty"),a&&$("."+e).addClass("savedProperty"),""==$("#hfavorites").val())$("#hfavorites").val(e);else{var f=$("#hfavorites").val();$("#hfavorites").val(f+","+e)}var v=$("."+e+" .listing-image").attr("id");addAnalytics(n,u,o,i,g,m,d,h,r,l,s,c),insertUserActivity("favorite_property_added",v)}else"Not authenticated, please login again."===t.msg?($("#haction").val("addFavorite|"+e+"|"+o+"|"+i+"|"+n+"|"+r+"|"+s+"|"+l+"|"+c+"|"+d+"|"+m+"|"+h+"|"+u+"|"+g),$("#sign-up-modal").modal("show")):alert(t.msg)})),new FbRealEstatePixelTracker({eventType:"InitiateCheckout",content_ids:[o||""]}).fireEvent()}}function getRecoveryToken(e){askingToken||($("#asking_password").val(""),askingToken=!0,$("#get-email-token").prop("disabled",!0),$("#get-email-token").text("Sending..."),$.ajax({url:"/pages/get_recovery_token.php",data:{user_email:e,origin:window.location.origin},method:"GET",dataType:"json"}).done((function(e){$("#get-email-token").text("SEND ME AN EMAIL"),e.error?alert(e.error.message):($("body").trigger("sayThanks","Your recovery email has been sent"),$("#asking_password").val(""),$("#asking-password-modal").modal("hide")),askingToken=!1,$("#get-email-token").prop("disabled",!1),$("#get-email-token").text("Send me an email")})))}function changePasswordWithToken(e){changingPassword||(e.password!=e.password_confirmation||e.password.length<6?(alert("passwords must be at least six characters and match the confirmation"),$("#changePassword").text("CHANGE PASSWORD")):(changingPassword=!0,$("#user_npassword").val(""),$("#user_npassword_c").val(""),$.ajax({url:"/pages/recovery_password.php",data:{user_token:e.user_token,password:e.password,password_confirmation:e.password_confirmation},method:"POST",dataType:"json"}).done((function(e){changingPassword=!1,$("#changePassword").text("CHANGE PASSWORD"),e.error?(alert(e.error.message),$("#pwchange-error").removeClass("hide"),setTimeout((function(){$("#pwchange-error").addClass("hide")}),2500)):($("#pwchange-success").removeClass("hide"),setTimeout((function(){$("#go-to-login").click(),$("#pwchange-success").addClass("hide")}),2e3))}))))}function getTokenValue(){var e=void 0,a=window.location.hash;return a.replace("#",""),a.split("&").forEach((function(a){a.indexOf("reset_pw_token")>-1&&(e=a.split("=")[1])})),e}function attachGoogleSignin(e){gapi.auth2.getAuthInstance().attachClickHandler(e,{},(function(e){console.log("---\x3e ",e.getBasicProfile().getName()),onSignIn(e)}),(function(e){console.log("---\x3e ",e)}))}function addGmailBtn(){for(var e=$(".google-signin-btn"),a=0;a<e.length;a++)attachGoogleSignin(e[a])}function facebookLoginAvaible(){return null!=$('meta[property="fb:app_id"]').attr("content")}function googleLoginAvaible(){return null!=$('meta[name="google-signin-client_id"]').attr("content")}function setGoogleButtons(){try{gapi.load("auth2",(function(){auth2=gapi.auth2.init({client_id:$("meta[name=google-signin-client_id]").attr("content"),cookiepolicy:"single_host_origin"}),addGmailBtn()}))}catch(e){}}function toCamelCase(e){return e.replace(/\b\w/g,(function(e){return e.toUpperCase()}))}function cleanDynamicTitle(e){return decodeURIComponent(e).replace(/%20/g," ").replace(/\+/g," ")}function forceRegistrationHandler(){$(".frl-company-logo").addClass("hide"),$("#frl-pnumber").mask("(999) 999-9999"),$("#frsd-pnumber").mask("(999) 999-9999"),$("#frf-pnumber").mask("(999) 999-9999"),$("#frc-pnumber").mask("(999) 999-9999"),$("#frse-pnumber").mask("(999) 999-9999"),$("#frv-schedule_phone").mask("(999) 999-9999");var e=!1;if(("facebook"==getUrlParam("share")||window.location.href.indexOf("share=facebook")>-1)&&""==$("#huser_id").val()&&(e=!0),window.location.href.indexOf("&keyword=")>-1&&$(".seo-dynamic-title").text(cleanDynamicTitle(getQueryParamByName("keyword"))),window.location.href.indexOf("&ssa=")>-1){"0"===getQueryParamByName("ssa")&&($(".mfr_streetAddress").hide(),$(".mfr_cityStateZip").replaceWith((function(){return"<h2>"+$(this).html()+"</h2>"})))}window.location.href.indexOf("&tags=")>-1&&$("#frg-h-tags").val(decodeURIComponent(getQueryParamByName("tags"))),window.location.href.indexOf("/share")>7&&$("#force-share-link").length>0&&($("#force-share-link").modal("show"),buildLinkForceRegistration(),$("#frg-source").on("change",buildLinkForceRegistration),$("#frg-registration").on("change",buildLinkForceRegistration),$("#fsl-btn-build").on("click",buildLinkForceRegistration),$("#page").addClass("blur-modal"),$("#force-share-link").on("hide.bs.modal",(function(e){$("#page").removeClass("blur-modal")})),forceRegistrationAdjustment("force-share-link"),$("#frg-adwords, #frg-tags, #frg-show-street-address").on("change",buildLinkForceRegistration)),window.location.href.indexOf("/light?")>7&&$("#force-light-registration").length>0&&watchUserLoged((function(){$("#frl-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frl","force-light-registration")})),$("#force-light-registration").on("show.bs.modal",(function(e){_isPropertyDetails3()?$("#page").addClass("blur-modal"):$("#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-light-registration")})),$("#force-light-registration").on("hide.bs.modal",(function(e){_isPropertyDetails3()?$("#page").removeClass("blur-modal"):$("#temp-container").removeClass("blur-modal")})),$("#force-light-registration").modal("show")})),window.location.href.indexOf("/virtual?")>7&&$("#force-virtual-registration").length>0&&watchUserLoged((function(){$("#force-virtual-registration").on("show.bs.modal",(function(e){_isPropertyDetails3()?$("#page").addClass("blur-modal"):$("#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-virtual-registration")})),$("#force-virtual-registration").on("hide.bs.modal",(function(e){_isPropertyDetails3()?$("#page").removeClass("blur-modal"):$("#temp-container").removeClass("blur-modal")})),$("#force-virtual-registration").modal("show")})),window.location.href.indexOf("/sold?")>7&&$("#force-sold-registration").length>0&&($("#force-sold-registration").on("shown.bs.modal",(function(){$("#sign-up-modal").modal("hide")})),watchUserLoged((function(){$("#frsd-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frsd","force-sold-registration")})),$("#force-sold-registration").on("show.bs.modal",(function(e){$("#temp-container").addClass("blur-modal")})),$("#force-sold-registration").on("hide.bs.modal",(function(e){_isPropertyDetails3()||$("#temp-container").addClass("blur-modal")})),$("#force-sold-registration").modal("show"),initialize_modal_sold()}))),window.location.href.indexOf("/full?")>7&&$("#force-full-registration").length>0&&watchUserLoged((function(){$("#frf-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frf","force-full-registration")})),$("#force-full-registration").on("show.bs.modal",(function(e){$(_isPropertyDetails3()?"#page":"#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-full-registration")})),$("#force-full-registration").on("hide.bs.modal",(function(e){$(_isPropertyDetails3()?"#page":"#temp-container").removeClass("blur-modal")})),$("#force-full-registration").modal("show")})),window.location.href.indexOf("/combined?")>7&&$("#force-combine-registration").length>0&&watchUserLoged((function(){if(e){var a=$("#force-combine-registration .frc-btn-facebook").html();a=a.replace("Continue with Facebook","Confirm Your Registration"),$("#force-combine-registration .frc-btn-facebook").html(a)}$("#frc-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frc","force-combine-registration")})),$("#force-combine-registration").on("show.bs.modal",(function(e){$("#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-combine-registration")})),$("#force-combine-registration").on("hide.bs.modal",(function(e){$("#temp-container").removeClass("blur-modal")})),$("#force-combine-registration").modal("show")}),(function(){if($("#force-combine-registration").modal("hide"),e){var a=$("#force-combine-registration .frc-btn-facebook").html();a=a.replace("Confirm Your Registration","Continue with Facebook"),$("#force-combine-registration .frc-btn-facebook").html(a)}})),window.location.href.indexOf("/social?")>7&&$("#force-social-registration").length>0&&watchUserLoged((function(){if(e){var a=$("#force-social-registration .frc-btn-facebook").html();a=a.replace("Continue with Facebook","Confirm Your Registration"),$("#force-social-registration .frc-btn-facebook").html(a)}$("#force-social-registration").on("show.bs.modal",(function(e){$("#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-social-registration")})),$("#force-social-registration").on("hide.bs.modal",(function(e){$("#temp-container").removeClass("blur-modal")})),$("#force-social-registration").modal("show")}),(function(){if($("#force-social-registration").modal("hide"),e){var a=$("#force-social-registration .frc-btn-facebook").html();a=a.replace("Confirm Your Registration","Continue with Facebook"),$("#force-social-registration .frc-btn-facebook").html(a)}})),window.location.href.indexOf("/combined?")>7&&$("#force-search-registration").length>0&&watchUserLoged((function(){if(e){var a=$("#force-search-registration > div.modal-dialog > div > div > button.btn.frc-btn-facebook").html();a&&(a=a.replace("Continue with Facebook","Confirm Your Registration"),$("#force-search-registration > div.modal-dialog > div > div > button.btn.frc-btn-facebook").html(a))}$("#frse-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frse","force-search-registration")})),$("#force-search-registration").on("show.bs.modal",(function(e){$("#temp-container").addClass("blur-modal"),forceRegistrationAdjustment("force-search-registration")})),$("#force-search-registration").on("hide.bs.modal",(function(e){$("#temp-container").removeClass("blur-modal")})),$("#force-search-registration").modal("show")}),(function(){if($("#force-search-registration").modal("hide"),e){var a=$("#force-search-registration .frc-btn-facebook").html();a=a.replace("Continue with Facebook","Confirm Your Registration"),$("#force-search-registration .frc-btn-facebook").html(a)}}))}function forceRegistrationAdjustment(e){var a=document.documentElement.clientWidth,t=void 0;setTimeout((function(){var o=$("#"+e+" > div.modal-backdrop.fade.in").height();t=a>750?.7*o:80,$("#"+e+" > div.modal-dialog").css({top:t+"px !important"}),$("#"+e+" > div.modal-backdrop.fade.in").css({height:$("#"+e+" > div.modal-backdrop.fade.in").height()+o+"px"})}),1e3)}function sendForceRegistration(e,a){$(".forced-registration-btn").prop("disabled",!0);var t=$(".forced-registration-btn").html();if($(".forced-registration-btn").html("Saving..."),"force-sold-registration"===a){if(!$("#zipcode").val())return void alert("Please, select a valid address.");window.location.href="/homevalue?search_address="+$("#address").val()+"&address_auto="+$("#address_auto").val()+"&street="+$("#street").val()+"&city="+$("#city").val()+"&state="+$("#state").val()+"&zipcode="+$("#zipcode").val()+"&latitude="+$("#CmaLatitude").val()+"&longitude="+$("#CmaLongitude").val()}var o=$("#"+e+"-fname").val(),i=$("#"+e+"-lname").val(),n=$("#"+e+"-email").val(),r=$("#"+e+"-pnumber").val(),s=($("#frg-h-tags").val()||"").trim(),l=($("#hlead_intent").val()||"buyer").trim(),c="",d="";if("force-light-registration"==a||"force-virtual-registration"==a||"force-combine-registration"==a||"force-full-registration"==a||"force-sold-registration"==a||"force-search-registration"==a){d=$("#"+e+"-h_robot_field").val();c=r.replace(/[^A-Z0-9]/gi,"");var m=o.split(" ");if(m.length>1){var h=[];m.forEach((function(e){""!=e&&h.push(e)})),i=h.pop(),o=h.join(" ")}else if(""===i)return alert("Please enter your First and Last Name"),$(".forced-registration-btn").prop("disabled",!1),void $(".forced-registration-btn").html(t)}else i=$("#"+e+"-lname").val(),c=$("#"+e+"-pass").val();var u={referrer:getQueryParamByName("share")};if("force-full-registration"==a){var g=parseInt($("#frg-price-min").val().trim().replace(/[^0-9.]/g,"")),p=parseInt($("#frf-price-max").val().trim().replace(/[^0-9.]/g,"")),f=$("#frg-buy").val(),v="yes"==$("input[name=frf-buyer]:checked").val()?"Yes":"No",_=g||p?g&&p?formatPriceUserFriendly(g)+" - "+formatPriceUserFriendly(p):g&&!p?formatPriceUserFriendly(g)+"+":"< "+formatPriceUserFriendly(p):"Any";u.first_time_home_buyer=v,u.price_range=_,u.planning_to_buy=f}"force-sold-registration"==a&&(u.home_address=$("#frsd-address").val().trim()||"");var b="force-search-registration"==a,w="forced_registration_"+(b?"search":"property")+"_page_"+(b?"combined":a.split("-")[1].replace("combine","combined")||"");if(b){var y="",k=parseInt($("#min_bedrooms").val().trim()),S=parseInt($("#max_bedrooms").val().trim()),C=parseInt($("#min_bathrooms").val().trim()),x=parseInt($("#max_bathrooms").val().trim()),T=parseInt($("#min_price").val().trim()),O=parseInt($("#max_price").val().trim());$("#hmulti_search").val().trim()&&(y+=$("#hmulti_search").val().trim()),(k||S)&&(y+=(y?", ":"")+(k&&S?k+"-"+S:k?k+"+":"<"+S)+" beds"),(C||x)&&(y+=(y?", ":"")+(C&&x?C+"-"+x:C?C+"+":"<"+x)+" baths"),(T||O)&&(y+=(y?", ":"")+(T&&O?formatPriceUserFriendly(T)+" - "+formatPriceUserFriendly(O):T?formatPriceUserFriendly(T)+"+":"<"+formatPriceUserFriendly(O))),y&&(u.criteria=y),u.search_url=window.location.origin+"/search"+window.location.hash}var P={site_id:0,phone:r,f_name:o,l_name:i,r_email:n,r_password:c,extra:u,h_robot_field:d,form_source_url:window.location.href,is_time_event_form:!0,time_event_type:w,lead_type:l};s&&(P.tags=s),"undefined"!=typeof grecaptcha&&grecaptcha.ready((function(){grecaptcha.execute("6LfNOsoUAAAAAKTst6hjCdK0tmeiA4GVzqBjwScC",{action:"signup_process"}).then((function(r){P.recaptchaToken=r,$.ajax({url:"/pages/signup_with_recaptcha.php",data:P,method:"POST",dataType:"json"}).done((function(r,s,l){if($(".forced-registration-btn").prop("disabled",!1),$(".forced-registration-btn").html(t),1==r.status){var c=l.getResponseHeader("Authorization");c&&localStorage.setItem("authorization",c),_isPropertyDetails3()&&($("property-details").attr("user",JSON.stringify(r)),$("property-details").attr("isLogged",!0)),signupQuestionFirst("followUp","250px"),$("body").trigger("userSignUp",""),afterAuth(o,i,n,r.agent||null,r.extra_data||{}),$("#huser_id").val(r.user_id).trigger("change"),$("#update_user_email").val(n),("force-sold-registration"!=a&&$("#hsale_price").val()&&$("#hcity").val()&&$("#hstate").val()||"force-search-registration"==a)&&saveSearch(void 0,!0),$(".favoritesCount").html("0"),$(".savedSearchesCount").html("0"),$("#signupBtn").trigger({type:"signup_success"}),-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables")&&$("#favLink").attr("onclick",'saveFavorite("'+$("#hmls_id").val()+"_"+$("#hmls_num").val()+'","'+$("#hmls_num").val()+'")'),$("#"+a).modal("hide")}else alert(r.msg);$("#"+e+"-form-registration > button:nth-of-type(1)").removeAttr("disabled"),$("#"+e+"-form-registration > button:nth-of-type(1)").text("VIEW PHOTOS")}))}))}))}function landingModalHandler(){window.location.href.indexOf("/landing/")<0&&window.location.href.indexOf("/landing")>7&&$("#modal-landing-share-link").length>0&&(buildLinkLandingPage(),$("#modal-landing-share-link").modal("show"),$("#lsm-btn-build").on("click",buildLinkLandingPage))}function runAdsTracking(){try{fbq("track","Lead",{content_name:"idx_website",content_category:"contact"}),console.log("facebook pixel lead track...")}catch(e){console.log("no facebook pixel set...")}try{goog_report_conversion(),console.log("google ad conversion")}catch(e){console.log("no google ads conversion set...")}}function buildLinkForceRegistration(){var e=$("#view_layout"),a=$("#frg-adwords"),t=$("#frg-tags"),o=$("#frg-show-street-address"),i=encodeURI(decodeURIComponent(window.location.href.replace("/share",""))),n="share=".concat($("#frg-source").val()),r=$("#frg-registration").val(),s="";if("sold"===r)s=i.replace("homes-for-sale/","homes-for-sale/comparables/").concat("/").concat(r).concat("?").concat(n);else if(void 0===$("#hpropertyid").val()){var l="";"map_view"===e.val()||"hybrid_view"===e.val()?(l=l.concat("/search/").concat(r).concat("?").concat("view="+e.val()+"&").concat(n).concat("#"),s=i.replace("/search",l)):(l=l.concat("/search/").concat(r).concat("?").concat(n).concat("#"),s=i.indexOf("/search#")>-1?i.replace("/search#",l):i.replace("/search?",l))}else s=i.concat("/").concat(r).concat("?").concat(n);if(""!==a.val()&&(s=s.concat("&keyword="+encodeURIComponent(a.val().trim()))),""!==t.val().trim()&&(s=s.concat("&tags="+encodeURIComponent(t.val().trim()))),o.is(":checked"))s=s.concat("&ssa="+encodeURIComponent("1"));else{let e=(s=s.concat("&ssa="+encodeURIComponent("0"))).split("/");s="sold"===r?s.replace(e[8],"na"):s.replace(e[7],"na")}$("#frg-url").val(s),$("#fsl-btn-preview").attr("href",s),copyToClipboard("#frg-url")}function buildLinkLandingPage(){var e=window.location.protocol+"//"+window.location.hostname+"/landing"+window.location.pathname.replace("/landing","");$("#lsm-url").val(e),$("#lsm-btn-preview").attr("href",e),copyToClipboard("#lsm-url")}function copyToClipboard(e){$(e).select(),document.execCommand("copy")}function goToLogin(e){$("#"+e).modal("hide"),$("#sign-up-modal").on("hidden.bs.modal",(function(){""===$("#huser_id").val()&&$("#"+e).modal("show")})),$("#asking-password-modal").on("shown.bs.modal",(function(){$("#"+e).modal("hide"),$("#asking-password-modal").on("hidden.bs.modal",(function(){""!==$("#huser_id").val()||$("#sign-up-modal").is(":visible")||$("#"+e).modal("show")}))})),$("#sign-up-modal").modal("show"),$("#signupForm > a").click(),$("#change-password-modal").modal("hide")}function watchUserLoged(e,a){$("#huser_id").on("change",(function(){""===$("#huser_id").val()?e():a&&a()}))}function goToForceLight(e){$("#"+e).modal("hide"),$("#force-light-registration").modal("show"),$("#frl-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frl","force-light-registration")})),watchUserLoged((function(){$("#force-light-registration").modal("show"),$("#frl-form-registration").on("submit",(function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;sendForceRegistration("frl")}))}))}function initialize_modal_sold(){var e=new google.maps.LatLng(parseFloat($("#lat").val()),parseFloat($("#lng").val())),a={zoom:15,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,center:e};mapSold=new google.maps.Map(document.getElementById("map-canvas"),a);new google.maps.Marker({map:mapSold,position:e});setTimeout((function(){google.maps.event.trigger(mapSold,"resize"),mapSold.setCenter(e),mapSold.panBy(0,-100)}),1500),$("#address_auto").on("change",(function(){setTimeout((function(){""===$("#zipcode").val()?$("#zip-message").removeClass("hide"):$("#zip-message").addClass("hide")}),1500)})),$("#frsd-address").geocomplete({types:["geocode"]}).bind("geocode:result",(function(e,a){var t=a.geometry.location.lat(),o=a.geometry.location.lng(),i=window.location.origin+"/homes-for-sale/comparables/"+t+"/"+o;console.log(i),$("#huser_id").on("change",(function(){""!=$("#huser_id").val()&&(window.location=i)}))}))}function initForceForgotOptions(){$("#sign-up-modal").on("shown.bs.modal",(function(){if($("#sign-up-modal").data("bs.modal")&&"static"==$("#sign-up-modal").data("bs.modal").options.backdrop&&!$("#sign-up-modal").data("bs.modal").options.keyboard){$("#asking-password-modal").modal({backdrop:"static",keyboard:!1,show:!1});$("#cancel-ask-token").hide()}}))}function initForceSignupOptions(){$("#sign-up-modal").on("shown.bs.modal",(function(){$("#sign-up-modal").data("bs.modal")&&"static"==$("#sign-up-modal").data("bs.modal").options.backdrop&&!$("#sign-up-modal").data("bs.modal").options.keyboard&&$("#loginCancelBtn").hide()}))}function createCookie(e,a,t){if(t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var i="; expires="+o.toGMTString()}else i="";document.cookie=e+"="+a+i+"; path=/"}function readCookie(e){for(var a=e+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){for(var i=t[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(a))return i.substring(a.length,i.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}function slugify(e){return null!=e&&""!=e||(e="-"),e.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"")}function checkUrlParam(e){return/\.(gif|jpg|jpeg|png)\?.+\=.+/gi.test(e)}function insertUserActivity(e,a,t){if(e){var o={type:e,url:window.location.href};switch(e){case"property_viewed":case"favorite_property_added":case"favorite_property_removed":o.property_id=a;break;case"favorite_property_added_details":o.type="favorite_property_added",o.property_id=a,o.property_details=!0;break;case"favorite_property_removed_details":o.type="favorite_property_removed",o.property_id=a,o.property_details=!0;break;case"search_save_added":case"search_save_removed":case"search_performed":o.search_data=t||{};break;case"valuation_inquiry":o.home_data=t||{};break;case"property_showing_scheduled":o.property_id=a,o.showing_data=t||{};break;case"contact_emailed":o.property_id=a,o.contact_data=t||{};break;case"user_data_updated":o.user_data=t||{}}$.ajax({url:"/pages/insert_user_activity.php",data:o,method:"POST",dataType:"json"}).done((function(e){}))}}$(document).ready((function(){"undefined"!=typeof Toast&&"undefined"==typeof toast&&(toast=new Toast),$("body").on("click","#finishCTA",(function(){$(".popupCTA, .popupOverlay, .message").removeClass("show")})),$("body").on("click",".closeCTA, .popupOverlay, #consultNo",(function(){$(".popupCTA, .popupOverlay, .message").removeClass("show"),sendSignupQuestions()})),$("body").on("click",".scheduleConsult button",(function(){if(""==$("#signupQuestionConsultTimes").val())alert("Please enter the time for the consultation");else{var e=globalSignupQuestionPaths[globalSignupQuestionType+"Questions"][globalSignupQuestionStep];globalSignupQuestionResponses[e]=$("#signupQuestionConsultTimes").val(),globalSignupQuestionStep++,$(".scheduleConsult").removeClass("show"),$(".confirmConsult").addClass("show"),$(".signupContent").css("height","150px"),sendSignupQuestions()}})),$(".frc-btn-google").show(),$(".frc-btn-facebook").show(),$(".social-or").show(),googleLoginAvaible()?setGoogleButtons():$(".frc-btn-google").remove(),facebookLoginAvaible()||$(".frc-btn-facebook").remove(),facebookLoginAvaible()||googleLoginAvaible()||($(".social-or").remove(),$("#frg-registration > option[class=has-social]").remove(),$("#frg-registration > option[class=has-social]").remove()),$("body").on("userSignUp",(function(e,a){$("#thankyou-forced").is(":visible")&&thankYouModal.hide(),setTimeout((function(){thankYouModal.show(a||"")}),50)})),$("body").on("sayThanks",(function(e,a){$("#thankyou-forced").is(":visible")&&thankYouModal.hide(),setTimeout((function(){thankYouModal.show(a||"")}),50)})),$(".get_this_year").text((new Date).getFullYear()),$("#signup_phone").mask("(999) 999-9999"),$(".phone_mask").mask("(999) 999-9999"),window.location.hash.indexOf("reset_pw_token=")>-1&&($("#change-password-modal").modal("show"),$("#changePassword").on("click",(function(){$("#changePassword").text("Sending..."),changePasswordWithToken({password:$("#user_npassword").val(),password_confirmation:$("#user_npassword_c").val(),user_token:getTokenValue()})}))),$("#open-forgot-pass").on("click",(function(){$("#sign-up-modal").modal("hide"),$("#asking-password-modal").modal("show")})),$("#back-to-sign-up").on("click",(function(){$("#asking-password-modal").modal("hide"),$("#sign-up-modal").modal("show")})),$("#go-to-login").on("click",(function(){$("#sign-up-modal").modal("show"),$("#signupForm > a").click(),$("#change-password-modal").modal("hide")})),$("#get-email-token").on("click",(function(){getRecoveryToken($("#asking_password").val())}));let e={user_info:"yes"};const a=window.location.search,t=new URLSearchParams(a);t.has("utm_source")&&(e["retarget-utm"]={utm_source:t.get("utm_source")},(window.location.search.indexOf("ads_auto_login=retarget_brivity_facebook_ads")>0||window.location.search.indexOf("brivity_connect=ads-remarket")>0||window.location.search.indexOf("brivity_leads=brivity_ads")>0)&&(e["retarget-utm"].ads_auto_login="retarget_brivity_facebook_ads",e["retarget-utm"].url=window.location.href,""!==document.referrer&&(e["retarget-utm"].referrer=document.referrer)),t.has("utm_medium")&&(e["retarget-utm"].utm_medium=t.get("utm_medium")),t.has("utm_campaign")&&(e["retarget-utm"].utm_campaign=t.get("utm_campaign")),t.has("utm_type")&&(e["retarget-utm"].utm_type=t.get("utm_type"))),$.ajax({url:"/pages/is_logged.php",data:e,method:"POST",dataType:"json"}).done((function(e){_isPropertyDetails3()&&e?.logged&&($("property-details").attr("user",JSON.stringify(e?.lead_data)),$("property-details").attr("isLogged",!0)),window.location.hash.indexOf("signup")>8&&!e.logged?($("#sign-up-modal").modal("show"),$("#sign-up-modal").addClass("in")):window.location.hash.indexOf("showlogin")>8&&!e.logged&&($("#sign-up-modal").modal("show"),$("#sign-up-modal").find("#create").removeClass("active in"),$("#sign-up-modal").find("#signin").addClass("active in"));let a={user_id:0,email:"",phone:"",f_name:"",l_name:"",brivity_uuid:"",blossorId:""};if($("#hblossorid").val()&&(a.blossorId=$("#hblossorid").val()),e.logged)$("#huser_id").val(e.user_id).trigger("change"),$("#huser_email").val(e.lead_data.email),$("#huser_first_name").val(e.lead_data.first_name),$("#huser_last_name").val(e.lead_data.last_name),$("#not-logged-in").hide(),$("#logged-in").show(),$(".topBarProfile .profileName").text("Hi "+(e.lead_data.first_name||"")+"!"),!0===e.logged&&(reactLoginPhoneNumber=e.lead_data.phone),a.email=e.lead_data.email,a.phone=e.lead_data.phone,a.f_name=e.lead_data.first_name,a.l_name=e.lead_data.last_name,a.brivity_uuid=e.uuid,a.user_id=e.user_id,e.agent&&e.agent.agent_phone?($(".topBarAgentPhoneLabel span").text(e.agent.agent_phone).show(),$(".topBarAgentPhoneLabel").show(),$(".topBarAgentPhoneLabel").attr("href","tel:"+e.agent.agent_phone.replace(/[^0-9.]/g,""))):$(".topBarAgentPhoneLabel").hide(),e.lead_data.image_url&&-1!=e.lead_data.image_url.search("http")&&$("#site-registration-bar .topBarPic").attr("style",'background-image: url("'+e.lead_data.image_url+'");'),e.favorites&&$(".favoritesCount").html(e.favorites),e.saved_searches&&$(".savedSearchesCount").html(e.saved_searches);else{if(window.location.search.indexOf("ads_auto_login=brivity_facebook_ads")>0?loginLastFacebookLeadGenerated():window.location.search.indexOf("ads_auto_login=retarget_brivity_facebook_ads")>0?$("#facebook-login-modal").modal("show"):(window.location.search.indexOf("brivity_connect=ads-remarket")>0||window.location.search.indexOf("brivity_leads=brivity_ads")>0)&&-1===window.location.search.indexOf("hide_signup_modal=true")?$("#sign-up-modal").modal("show"):$("#huser_id").trigger("change"),-1!==window.location.href.indexOf("/search")){let e=$("#hforced_search_registration").val();e&&1==e&&(window.location.href.indexOf("/share")>7||window.location.href.indexOf("/combined?")>7||($("#signupCancelBtn").hide(),$("#sign-up-modal").modal({backdrop:"static",keyboard:!1})))}const e="google_one_tap_show";getCookieByName(e)||(setCookieForMinutes(e,"any",60),showGoogleOneTap(!1))}var t=!1;if(-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables"))propertyDetailsTopBar(e),t=!0;else if(-1!==window.location.href.indexOf("/homes-for-sale/")&&-1===window.location.href.indexOf("/homes-for-sale/comparables"))isLoggedChecked=!0,e.logged&&$("#marketReportBtn").attr("onclick","signupMonthly()");else if(!e.logged&&-1!==window.location.href.indexOf("/homes-for-sale/comparables")){$("#sign-up-modal").modal({backdrop:"static",keyboard:!1});$("#sign-up-modal #signupCancelBtn").remove(),$("#signin #loginCancelBtn").remove()}t||trackSiteVisit(),$.ajax({url:"/pages/get_jwtToken.php",data:a,method:"POST",dataType:"json"}).done((function(e){if(1==e.showBanner){branch.init("key_live_llQHbHbL910bvlNJU6OJ4gphACgjYBKc");const a={data:{token:e.token,$journeys_title:"Continue your search on our app"}};branch.setBranchViewData(a)}}))})),$("#topBarLogout").bind("click",(function(){userLogOut((function(){window.location.href="/"}))})),$("#loginBtn").bind("click",(function(){""==$("#search_password").val()||""==$("#search_username").val()?alert("Please enter a Username and Password"):($("#loginBtn").text("Logging In..."),$("#loginBtn").prop("disabled",!0),doLogin())})),$("#loginCancelBtn, #signupCancelBtn").click((function(){$("#haction").length&&""!=$("#haction").val()&&$("#haction").val("")})),$(".login-ss").bind("click",(function(){$("#haction").val("saveSearch-0"),(saveSearchCookie||Function)()})),$("#signupForm").submit((function(e){e.preventDefault();var a=$("#signup_fname").val().trim(),t="",o=$("#signup_phone").val().trim(),i="",n=$("#signup_email").val().trim(),r=$("#sgnf_h_robot_field").val(),s=window.location.href,l=($("#frg-h-tags").val()||"").trim(),c=($("#hlead_intent").val()||"buyer").trim();if(!a||!o||!n)return void alert("Form incomplete, please check all fields are filled.");if(a.toLowerCase().includes("n/a"))return void alert("Invalid user name N/A.");if($("#signup_lname").val())t=$("#signup_lname").val(),i=$("#signup_password").val();else{i=o.replace(/[^A-Z0-9]/gi,"");var d=a.split(" ");if(!(d.length>1))return void alert("Please enter your First and Last Name");var m=[];d.forEach((function(e){""!=e&&m.push(e)})),t=m.pop(),a=m.join(" ")}var h={site_id:0,phone:o,f_name:a,l_name:t,r_email:n,r_password:i,h_robot_field:r,form_source_url:s,action:$("#haction").val()||"",is_time_event_form:!0,time_event_type:"signup",lead_type:c};l&&(h.tags=l);var u=$("#signupForm").serializeArray(),g=["signup_fname","signup_lname","signup_phone","signup_email"];u.forEach((function(e){-1===g.indexOf(e.name)&&(h[e.name]=e.value)})),$("#signupBtn").text("Creating..."),$("#signupBtn").prop("disabled",!0),"undefined"!=typeof listingOwnerId&&listingOwnerId&&(h.listingAgentId=listingOwnerId);let p=getUtmParams();jQuery.isEmptyObject(p)||(h.utm_data=p),$.ajax({url:"/pages/signup.php",data:h,method:"POST",dataType:"json"}).done((function(e,i,r){if(1==e.status){var s=r.getResponseHeader("Authorization");s&&localStorage.setItem("authorization",s),_isPropertyDetails3()&&($("property-details").attr("user",JSON.stringify(e)),$("property-details").attr("isLogged",!0)),signupQuestionFirst("followUp","250px",!0)}$("#signupBtn").text("Create My Free Account"),$("#signupBtn").prop("disabled",!1),1==e.status?(e.extra_data=e.extra_data||{},e.extra_data.phone=o||"",$("#huser_id").val(e.user_id).trigger("change"),afterAuth(a,t,n,e.agent||null,e.extra_data||{}),$("#signup_fname").val(""),$("#signup_lname").val(""),$("#signup_email").val(""),$("#signup_password").val(""),$("#signup_phone").val(""),$("#update_user_email").val($("#signup_email").val()),$(".favoritesCount").html("0"),$(".savedSearchesCount").html("0"),$("#signupBtn").trigger({type:"signup_success"}),$("#haction").length&&""!=$("#haction").val()?"pdetails-save-favorite"==$("#haction").val()?($("#haction").val(""),saveFavorite($("#hmls_id").val()+"_"+$("#hmls_num").val(),$("#hmls_num").val(),$("#hblossorid").val(),$("#hprice").val())):doAction():$("#h_action").length&&""!=$("#h_action").val()?doAction():-1!==window.location.href.indexOf("/homes-for-sale/")&&$("#hpropertyid").length>0&&-1===window.location.href.indexOf("/homes-for-sale/comparables")?$("#favLink").attr("onclick",'saveFavorite("'+$("#hmls_id").val()+"_"+$("#hmls_num").val()+'","'+$("#hmls_num").val()+'")'):-1!==window.location.href.indexOf("/homes-for-sale/")&&-1===window.location.href.indexOf("/homes-for-sale/comparables")&&signupMonthly()):alert(e.msg)}))})),$("#phoneConfirmForm").submit((function(e){var a=$("#confirm_phone").val().trim();if($("#huser_id").val())if(a){var t=a.replace(/[^A-Z0-9]/gi,"");$("#confirmPhoneBtn span").text("Sending..."),$("#confirmPhoneBtn").attr("disabled",!0),$.ajax({url:"/pages/update_user_phone_password.php",data:{phone:a,password:t},method:"POST",dataType:"json"}).done((function(e){$("#confirmPhoneBtn span").text("Confirm Phone..."),$("#confirmPhoneBtn").removeAttr("disabled"),1==e.success?$("body").trigger("sayThanks","Data saved, now you can use the entered phone as your password"):alert(e.msg),$("#phone-confirm-modal").modal("hide")}))}else alert("Form incomplete, please check all fields are filled.");else alert("You need not be logged in first to send your phone number.")})),forceRegistrationHandler(),landingModalHandler(),initForceForgotOptions(),initForceSignupOptions(),$("#areas-city-container").length&&($("#areas-city-loading").show(),$("#areas-city-container").hide(),$.ajax({url:"/pages/get_area_cities.php",method:"POST",dataType:"json"}).done((function(e){if(e.status)if($("#areas-city-title").text(e.title||""),e.totalsMls)$.ajax({url:"/pages/search.php/listings_map?",method:"post",datatype:"json",data:{mlsId:e.totalsMls,status:"1|3"},success:function(a){var t=a.listings||[];t&&t.length&&e.cityListSections.forEach((function(e){e.forEach((function(e){var a=t.find((function(a){return a.city===e.city&&a.state===e.state}));e.total=a?a.total:e.total}))}));var o=parseAreasCityBlockContent(e.cityListSections);$("#areas-city-list").html(o),$("#areas-city-loading").hide(),$("#areas-city-container").show()}});else{var a=parseAreasCityBlockContent(e.cityListSections);$("#areas-city-list").html(a),$("#areas-city-loading").hide(),$("#areas-city-container").show()}else $("#areas-city-loading").hide(),$("#areas-city-container").hide()}))),$(document).on("DOMNodeInserted",(function(e){$("#sub-chat-window").bind("DOMSubtreeModified",(function(){var e=$("#sub-chat-window div.panel-heading.top-bar").attr("style");e.indexOf("important")<0&&$("#sub-chat-window div.panel-heading.top-bar").attr("style",e.replace(";"," !important;"));var a=$(".icon-help").css("color");$("#sub-chat-window div.panel-container div.panel-heading.top-bar > div.panel-title-container > h3").attr("style","color: "+a)}))}));let o=window.location.protocol+"//"+window.location.hostname+"/sitemaps";$.get(o).done((function(){$("#sitemapUrl").attr("href","/sitemaps"),$("#sitemapUrl").css({display:"inline"})})).fail((function(){let e=window.location.protocol+"//"+window.location.hostname+"/sitemap";$.get(e).done((function(){$("#sitemapUrl").attr("href","/sitemap"),$("#sitemapUrl").css({display:"inline"})})).fail((function(){}))}))}));var thankYouModal={show:function(e){e&&thankYouModal.setCustomMessage(e),$("#thankyou-forced").length>0?($("#thankyou-forced").modal("show"),setTimeout(this.hide,5e3)):($("body").append(this.modalSource),$("#thankyou-forced").modal("show"),this.setCustomMessage(this.getCustomMessage()),setTimeout(this.hide,5e3))},hide:function(){$("#thankyou-forced").length>0&&$("#thankyou-forced").modal("hide")},getCustomMessage:function(){return this.customMessage},setCustomMessage:function(e){this.customMessage=e,$("#thk-you-mdl-msg").length>0&&$("[id=thk-you-mdl-msg]").text(e)},customMessage:"",modalSource:'<div class="modal fade magic-modal text-center" id="thankyou-forced" tabindex="-1" role="dialog" aria-hidden="true">\n   <div class="modal-dialog" role="document">\n       <div class="modal-content">\n           <div class="modal-body text-center">\n               <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>\n               <div class="force-thank-you">\n                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#7ABD91" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle margin-bottom-20 margin-top-20" width="80" height="80" stroke-width="1.2"><path d="M22 11.07V12a10 10 0 1 1-5.93-9.14"></path><polyline points="23 3 12 14 9 11"></polyline></svg>\n                   <h4>Thank You.</h4>\n                   <p id="thk-you-mdl-msg"></p>\n               </div>\n               <iframe id="force-thank-you-iframe" style="border:0" width="0px" height="0px" src="/pages/confirmation.php"></iframe>\n               <div class="flex jc-center">\n                   <button type="button" class="btn btn-primary margin-top-0" data-dismiss="modal">\n                       <div class="flex ai-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg> Okay</div>\n                   </button>\n               </div>\n            </div>\n        </div>\n    </div>\n</div>'},globalSignupQuestionStep=0,globalSignupQuestionType="",globalSignupQuestionPaths={buy:["followUp","buyTimeline","mortgage","consult","scheduleConsult"],buyQuestions:["selling_or_buying","time_frame","mortgage_pre-approval","scheduled_consult","consultation"],sell:["followUp","sellTimeline","consultOrValue","scheduleConsult"],sellQuestions:["selling_or_buying","time_frame","scheduled_consult","consultation"],both:["followUp","buyTimeline","mortgage","sellTimeline","consultOrValue","scheduleConsult"],bothQuestions:["selling_or_buying","buy_time_frame","mortgage_pre-approval","sell_time_frame","scheduled_consult","consultation"]},globalSignupQuestionResponses={};function signupQuestionHomeValue(){signupQuestionsSet("No"),sendSignupQuestions(),$(".popupCTA, .popupOverlay").removeClass("show");let e=window.location.protocol+"//"+window.location.hostname+"/homevalue";$.get(e).done((function(){window.location.href=e})).fail((function(){e=window.location.protocol+"//"+window.location.hostname+"/home_value",$.get(e).done((function(){window.location.href=e})).fail((function(){console.log("Home value no found in thi site")}))}))}function signupQuestionFirst(e,a,t){$(".popupCTA, .popupOverlay").addClass("show"),$("."+e).addClass("show"),$(".popupBody").css("height",a),globalSignupQuestionStep=0,globalSignupQuestionType="",t&&1==t&&($("#signup-question-iframe").attr("src","/pages/confirmation.php?facebook=false"),setTimeout((function(){$("#signup-question-iframe").attr("src","")}),1500))}function signupQuestionsSet(e){if(e){var a=globalSignupQuestionPaths[globalSignupQuestionType+"Questions"][globalSignupQuestionStep];globalSignupQuestionResponses[a]=e}}function signupQuestionNext(e,a){if(""!=e&&(globalSignupQuestionType=e),a){var t=globalSignupQuestionPaths[globalSignupQuestionType+"Questions"][globalSignupQuestionStep];globalSignupQuestionResponses[t]=a}var o=globalSignupQuestionPaths[globalSignupQuestionType];$("."+o[globalSignupQuestionStep]).removeClass("show"),globalSignupQuestionStep++,$("."+o[globalSignupQuestionStep]).addClass("show")}function signupQuestionBack(){var e=globalSignupQuestionPaths[globalSignupQuestionType];$("."+e[globalSignupQuestionStep]).removeClass("show"),globalSignupQuestionStep--,$("."+e[globalSignupQuestionStep]).addClass("show")}function sendSignupQuestions(){if(globalSignupQuestionStep>0){var e={},a=0;for(var t in globalSignupQuestionResponses){if(!(a<globalSignupQuestionStep))break;e[t]=globalSignupQuestionResponses[t],a++}$.ajax({url:"/pages/signup_questions.php",data:e,method:"POST",dataType:"json"}).done((function(e){console.log(e)}))}}function getUrlParam(e){var a=new RegExp("[?&]"+e+"=([^]*)").exec(window.location.href);return null==a?null:a[1]||0}function formatPriceUserFriendly(e){for(;/(\d+)(\d{3})/.test(e.toString());)e=e.toString().replace(/(\d+)(\d{3})/,"$1,$2");return"$"+e}function getQueryParamByName(e,a){a||(a=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(a);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}function formatCreateDate(e){var a="";if(e){var t=e.split(/[- :]/);t[1]--,a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t[1]]+". "+t[2]+", "+t[0]}return a}function openCallModal(e,a,t){callModalSetup(e,"office-number-container","office-number-btn","office-number","tel",t),callModalSetup(a,"cell-number-container","cell-number-btn","cell-number","tel",t),$("#call-agent-modal").modal("show")}function callModalSetup(e,a,t,o,i,n){if(e&&""!==e){$("."+a).show(),n&&$("."+t).show(),$("#"+o).text(encphone(e));const r=encphone(e);$("#"+o).attr("href",i+":"+r),$("#"+o+"-btn").attr("href",i+":"+r),"cell-number"===o&&$("#"+o+"-btn-text").attr("href","sms:"+r)}else $("."+a).hide(),$("."+t).hide(),$("#"+o).text(""),$("#"+o).attr("href","")}function encphone(e){return atob(e.split("").map((e=>e.match(/[a-z]/i)?String.fromCharCode(e.charCodeAt(0)+(e.toLowerCase()<"n"?13:-13)):e)).join(""))}function openContactModal(e){var a=$("#huser_first_name").val()?$("#huser_first_name").val():"",t=$("#huser_last_name").val()?" "+$("#huser_last_name").val():"";$("#contact-modal-form #agentId").val(e),$("#contact-modal-form #name").val(a+t),$("#contact-modal-form #email").val($("#huser_email").val()?$("#huser_email").val():""),$("#contact-modal").modal("show")}function FbRealEstatePixelTracker(e){this.eventType="ViewContent",this.pixelData={content_type:"home_listing"},this.init=function(e){e&&Object.keys(e).forEach((a=>{"eventType"==a?"InitiateCheckout"!=e[a]&&"ViewContent"!=e[a]&&"Search"!=e[a]||(this.eventType=e.eventType):this.pixelData[a]=e[a]}))},this.fireEvent=function(e=0){if("function"!=typeof fbq){if(e<3){let a=this;setTimeout((function(){a.fireEvent(++e)}),2e3)}return!0}fbq("track",this.eventType,this.pixelData)},e&&this.init(e)}$("#contact-modal-form").submit((function(e){e.preventDefault();let a=$(this).find('input[name="age_required"]');if(a.length>0&&""!==a.val())return!1;var t=$("#contact-modal-form #agentId").val().trim(),o=$("#contact-modal-form #name").val().trim(),i=$("#contact-modal-form #email").val().trim(),n=$("#contact-modal-form #phone").val().trim(),r=$("#contact-modal-form #message").val().trim();if(o&&i&&n&&r){var s=window.location.href,l={contact_fullname:o,agent_id:t,contact_phone:n,contact_email:i,contact_message:r+"<br>URL: "+window.location.href,listing_agent_id:$("#hlisting_bragent_id").val(),h_robot_field:$("#hcontacmodal_robot_field").val(),form_source_url:s,time_event_type:"contact_form",primary_agent:!0},c=$("#contact-modal-form").serializeArray(),d=["name","number","email","message","hcontacmodal_robot_field"];c.forEach((function(e){-1===d.indexOf(e.name)&&(l[e.name]=e.value)}));$("#contact-modal-form #contact_agent_sendbtn").attr("disabled",!0),$("#contact-modal-form #contact_agent_sendbtn").html("Sending..."),$.ajax({url:"/pages/contact.php",data:l,method:"POST",dataType:"json"}).done((function(e){if($("#contact-modal-form #contact_agent_sendbtn").removeAttr("disabled"),$("#contact-modal-form #contact_agent_sendbtn").html("Send"),e&&e.status){if($("#contact-modal-form #name").val(""),$("#contact-modal-form #phone").val(""),$("#contact-modal-form #email").val(""),$("#contact-modal-form #message").val(""),$("#contact-modal").modal("hide"),$("body").trigger("sayThanks","The email has been sent"),""==$("#huser_id").val().trim()&&e.lead_data&&e.lead_data.lead_id){var a={login_user_id:e.lead_data.lead_id,login_form_email:i};$.ajax({url:"/pages/login.php",data:a,method:"POST",dataType:"json"}).done((function(e,a,t){if(e.status){var o=t.getResponseHeader("Authorization");o&&localStorage.setItem("authorization",o),$("#huser_id").val(e.user_id).trigger("change"),$("#update_user_email").val(i),$.ajax({url:"/pages/is_logged.php",data:{user_info:"yes"},method:"POST",dataType:"json"}).done((function(e){reactLoginPhoneNumber=e.lead_data.phone,console.log(e.lead_data.phone),e.logged&&(_isPropertyDetails3()&&($("property-details").attr("user",JSON.stringify(e?.lead_data)),$("property-details").attr("isLogged",!0)),null!=e.favorites&&$(".favoritesCount").html(e.favorites||0),null!=e.saved_searches&&$(".savedSearchesCount").html(e.saved_searches||0),afterAuth(e.lead_data.first_name,e.lead_data.last_name,i))}))}}))}}else $("#contact-modal-error #contact-modal-error-message").text(e.msg),$("#contact-modal-error").modal("show"),$("#contact-modal-error #contact-modal-error-button-close").off().on("click",(function(){setTimeout((function(){$("#contact-modal").modal("show")}),500)}))}))}else alert("Form incomplete, please check all fields are filled.")})),$("#contact-modal-form #phone").mask("(999) 999-9999");